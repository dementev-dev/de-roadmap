# **Data Vault 2.0: –∫–∞–∫ —Å–æ–±—Ä–∞—Ç—å —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∫–∞–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä**

*–î–ª—è —Ç–µ—Ö, –∫—Ç–æ —É–∂–µ —Å–ª—ã—à–∞–ª –ø—Ä–æ STG/ODS/DDS/DM, —Ñ–∞–∫—Ç—ã/–∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ SCD, –Ω–æ —Ö–æ—á–µ—Ç —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, —á—Ç–æ —Ç–∞–∫–æ–µ Data Vault –∏ –∑–∞—á–µ–º –æ–Ω –≤–æ–æ–±—â–µ –Ω—É–∂–µ–Ω.*

---

## 1. –ó–∞—á–µ–º –≤–æ–æ–±—â–µ –Ω—É–∂–µ–Ω Data Vault?

–ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–Ω–∞–∫–æ–º—è—Ç—Å—è —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏ —á–µ—Ä–µ–∑ –¥–≤–µ –º–æ–¥–µ–ª–∏:

* **3NF** (–ò–Ω–º–æ–Ω) ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —è–¥—Ä–æ: –º–Ω–æ–≥–æ —Ç–∞–±–ª–∏—Ü, —Å—Ç—Ä–æ–≥–∏–µ —Å–≤—è–∑–∏, –º–∏–Ω–∏–º—É–º –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è.
* **–ó–≤–µ–∑–¥–∞ (Star Schema)** (–ö–∏–º–±–∞–ª–ª) ‚Äî –≤–∏—Ç—Ä–∏–Ω—ã –ø–æ–¥ –æ—Ç—á—ë—Ç—ã: —Ñ–∞–∫—Ç + –Ω–µ—Å–∫–æ–ª—å–∫–æ ¬´–ø–ª–æ—Å–∫–∏—Ö¬ª –∏–∑–º–µ—Ä–µ–Ω–∏–π.

–≠—Ç–æ–≥–æ —Ö–≤–∞—Ç–∞–µ—Ç –¥–ª—è:

* 2‚Äì5 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤,
* –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Å—Ö–µ–º,
* –∑–∞–¥–∞—á —Ç–∏–ø–∞ ¬´—Å–¥–µ–ª–∞—Ç—å –æ—Ç—á—ë—Ç –¥–ª—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞/—Ñ–∏–Ω–∞–Ω—Å–æ–≤¬ª.

–ü—Ä–æ–±–ª–µ–º—ã –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è, –∫–æ–≥–¥–∞:

* –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ **—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–µ—Å—è—Ç–æ–∫ –∏ –±–æ–ª—å—à–µ** (CRM, –±–∏–ª–ª–∏–Ω–≥, ERP, —Å–∞–π—Ç, –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –ø–∞—Ä—Ç–Ω—ë—Ä—ã, —Å–∫–æ—Ä–∏–Ω–≥–∏‚Ä¶);
* —Å—Ö–µ–º—ã **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ –º–µ–Ω—è—é—Ç—Å—è**: –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –ø–æ–ª—è, —Å—É—â–Ω–æ—Å—Ç–∏, –Ω–æ–≤—ã–µ —Å–≤—è–∑–∏;
* –ø–æ—è–≤–ª—è—é—Ç—Å—è –∂—ë—Å—Ç–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ **–∞—É–¥–∏—Ç—É –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–µ**: ¬´–ø–æ–∫–∞–∂–∏—Ç–µ, –æ—Ç–∫—É–¥–∞ –≤–∑—è–ª—Å—è –≤–æ—Ç —ç—Ç–æ—Ç –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å, –ø–æ —à–∞–≥–∞–º¬ª.

–í–æ—Ç —Ç—É—Ç –æ–±—ã—á–Ω–∞—è 3NF/–ó–≤–µ–∑–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–∫—Ä–∏–ø–µ—Ç—å:

* –ª—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ ‚Üí –±–æ–ª—å–Ω–æ –ø–æ —è–¥—Ä—É –∏ –≤–∏—Ç—Ä–∏–Ω–∞–º;
* –∏—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–º–∞–∑–∞–Ω–∞ –ø–æ —Ä–∞–∑–Ω—ã–º –º–µ—Å—Ç–∞–º (–≥–¥–µ-—Ç–æ SCD, –≥–¥–µ-—Ç–æ –ª–æ–≥-—Ç–∞–±–ª–∏—Ü—ã, –≥–¥–µ-—Ç–æ –≤–æ–æ–±—â–µ –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏);
* –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –º–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç –Ω–∞ –º–µ—Å—è—Ü.

**Data Vault 2.0** –æ—Ç–≤–µ—á–∞–µ—Ç –∏–º–µ–Ω–Ω–æ –Ω–∞ —ç—Ç—É –±–æ–ª—å:

> –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã **–Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫** ‚Üí —ç—Ç–æ –Ω–µ ¬´—Ä–µ–º–æ–Ω—Ç –≤—Å–µ–≥–æ –¥–æ–º–∞¬ª, –∞ –ø—Ä–æ—Å—Ç–æ ¬´–¥–æ–∫—Ä—É—Ç–∏—Ç—å –µ—â—ë –æ–¥–∏–Ω –º–æ–¥—É–ª—å¬ª?

---

## 2. –ò–Ω—Ç—É–∏—Ü–∏—è: DV –∫–∞–∫ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä Lego

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –º–µ—Ç–∞—Ñ–æ—Ä–∞ DV ‚Äî —ç—Ç–æ **–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏–∑ —Ç—Ä—ë—Ö —Ç–∏–ø–æ–≤ –¥–µ—Ç–∞–ª–µ–π**:

* üî¥ **Hub (–•–∞–±)** ‚Äî *¬´–∫—Ç–æ/—á—Ç–æ —ç—Ç–æ¬ª*
  –°—É—â–Ω–æ—Å—Ç–∏: –∫–ª–∏–µ–Ω—Ç, –∑–∞–∫–∞–∑, –¥–æ–≥–æ–≤–æ—Ä, —Å—á—ë—Ç.
  –í–Ω—É—Ç—Ä–∏: –±–∏–∑–Ω–µ—Å-–∫–ª—é—á (`customer_id`, `contract_number`) + —Ç–µ—Ö–ø–æ–ª—è.

* ‚ö™ **Link (–õ–∏–Ω–∫)** ‚Äî *¬´–∫–∞–∫ –æ–Ω–∏ —Å–≤—è–∑–∞–Ω—ã¬ª*
  ¬´–ö–ª–∏–µ–Ω—Ç —Å–¥–µ–ª–∞–ª –∑–∞–∫–∞–∑¬ª, ¬´–¥–æ–≥–æ–≤–æ—Ä –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —Å—á—ë—Ç—É¬ª.
  –í–Ω—É—Ç—Ä–∏: —Å—Å—ã–ª–∫–∏ –Ω–∞ —Ö–∞–±—ã + —Ç–µ—Ö–ø–æ–ª—è.

* üü° **Satellite (–°–∞—Ç–µ–ª–ª–∏—Ç)** ‚Äî *¬´–∫–∞–∫–∏–µ —É –Ω–∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞ –∏ –∫–∞–∫ –æ–Ω–∏ –º–µ–Ω—è–ª–∏—Å—å¬ª*
  –ê—Ç—Ä–∏–±—É—Ç—ã —Å—É—â–Ω–æ—Å—Ç–∏ (–∏–º—è, email, —Å—Ç–∞—Ç—É—Å, —Ç–∞—Ä–∏—Ñ) + –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

–ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è:

> **–ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å, —Å–≤—è–∑–∏ –∏ –∞—Ç—Ä–∏–±—É—Ç—ã –∂–∏–≤—É—Ç –æ—Ç–¥–µ–ª—å–Ω–æ.**
> –¢–æ–≥–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–¥–Ω–æ–º –Ω–µ –ª–æ–º–∞—é—Ç –¥—Ä—É–≥–æ–µ.

–ù–∞ –∫–∞—Ä—Ç–∏–Ω–∫–µ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```mermaid
erDiagram
    HUB_CUSTOMER ||--o{ SAT_CUSTOMER_INFO : "–∏–º–µ–µ—Ç –∞—Ç—Ä–∏–±—É—Ç—ã"
    HUB_CUSTOMER ||--o{ LINK_ORDER_CUSTOMER : "—É—á–∞—Å—Ç–≤—É–µ—Ç –≤"
    HUB_ORDER ||--o{ LINK_ORDER_CUSTOMER : "—Å–æ–∑–¥–∞–Ω"
    LINK_ORDER_CUSTOMER ||--o{ SAT_ORDER_STATUS : "–∏–º–µ–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞—Ç—É—Å–æ–≤"

    HUB_CUSTOMER {
        varchar customer_bk PK "–ë–∏–∑–Ω–µ—Å-–∫–ª—é—á: '101'"
        varchar record_source
        timestamp load_dttm
    }
    
    HUB_ORDER {
        varchar order_id PK "–ë–∏–∑–Ω–µ—Å-–∫–ª—é—á: '5001'"
        varchar record_source
        timestamp load_dttm
    }
    
    LINK_ORDER_CUSTOMER {
        varchar link_key PK "–•—ç—à (order_id + customer_bk)"
        varchar order_id FK
        varchar customer_bk FK
        varchar record_source
        timestamp load_dttm
    }
    
    SAT_CUSTOMER_INFO {
        varchar customer_bk FK
        varchar hashdiff
        timestamp valid_from
        timestamp valid_to
        varchar name
        varchar email
        varchar city
        varchar record_source
        timestamp load_dttm
    }
    
    SAT_ORDER_STATUS {
        varchar link_key FK
        varchar hashdiff
        timestamp valid_from
        timestamp valid_to
        varchar status
        varchar record_source
        timestamp load_dttm
    }
```

–ö–∞–∫ —ç—Ç–æ —á–∏—Ç–∞—Ç—å:

* üî¥ **HUB_CUSTOMER / HUB_ORDER** ‚Äî ¬´—ç—Ç–æ—Ç –∫–ª–∏–µ–Ω—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç¬ª, ¬´—ç—Ç–æ—Ç –∑–∞–∫–∞–∑ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç¬ª;
* ‚ö™ **LINK_ORDER_CUSTOMER** ‚Äî ¬´–∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –∑–∞–∫–∞–∑ —Å–¥–µ–ª–∞–ª –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –∫–ª–∏–µ–Ω—Ç¬ª;
* üü° **SAT_‚Ä¶** ‚Äî –∫–∞–∫ –º–µ–Ω—è–ª–∏—Å—å –∞—Ç—Ä–∏–±—É—Ç—ã (email, —Å—Ç–∞—Ç—É—Å –∏ —Ç.–ø.) –≤–æ –≤—Ä–µ–º–µ–Ω–∏.

---

## 3. –¢—Ä–∏ —Ç–∏–ø–∞ —Ç–∞–±–ª–∏—Ü –≤ Data Vault 2.0

–ß—É—Ç—å –º–µ–Ω–µ–µ ¬´—Å–∫–∞–∑–æ—á–Ω–æ¬ª, —á—É—Ç—å –±–æ–ª–µ–µ —Ç–µ—Ö–Ω–∏—á–Ω–æ.

### 3.1. Hub ‚Äî —Å—É—â–Ω–æ—Å—Ç—å –∏ –µ—ë –±–∏–∑–Ω–µ—Å-–∫–ª—é—á

**Hub** —Å–æ–¥–µ—Ä–∂–∏—Ç:

* –±–∏–∑–Ω–µ—Å-–∫–ª—é—á (`customer_bk`, `order_id`, `contract_number`);
* —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

  * `record_source` ‚Äî –∏–∑ –∫–∞–∫–æ–π —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏—à–ª–∞ –ø–µ—Ä–≤–∞—è –∑–∞–ø–∏—Å—å;
  * `load_dttm` ‚Äî –∫–æ–≥–¥–∞ –ø–æ–ø–∞–ª–∞ –≤ DV;
  * –∏–Ω–æ–≥–¥–∞ ‚Äî —Ö—ç—à –±–∏–∑–Ω–µ—Å-–∫–ª—é—á–∞ (`hk_customer`).

–ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

* **–æ–¥–∏–Ω –±–∏–∑–Ω–µ—Å-–∫–ª—é—á ‚Äî –æ–¥–∏–Ω —Ö–∞–±** (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –Ω–∞ —Å—É—â–Ω–æ—Å—Ç—å, –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏);
* —Ö–∞–± –Ω–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ –∞—Ç—Ä–∏–±—É—Ç—ã (–∏–º—è, email) ‚Äî —Ç–æ–ª—å–∫–æ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å.

–ü—Ä–æ—Å—Ç–µ–π—à–∏–π DDL-—Å–∫–µ–ª–µ—Ç:

```sql
CREATE TABLE hub_customer (
    hk_customer     BYTEA        PRIMARY KEY,        -- —Ö—ç—à –æ—Ç BK
    customer_bk     VARCHAR(50)  NOT NULL,           -- business key
    record_source   VARCHAR(50)  NOT NULL,
    load_dttm       TIMESTAMP    NOT NULL
);
```

### 3.2. Link ‚Äî —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å—É—â–Ω–æ—Å—Ç—è–º–∏

**Link** –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–∫—Ç —Å–≤—è–∑–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä:

* –∑–∞–∫–∞–∑ ‚Üî –∫–ª–∏–µ–Ω—Ç,
* –¥–æ–≥–æ–≤–æ—Ä ‚Üî —Å—á—ë—Ç,
* –∫–∞—Ä—Ç–∞ ‚Üî –∫–ª–∏–µ–Ω—Ç.

–ü—Ä–∏–º–µ—Ä—ã –±–∏–∑–Ω–µ—Å-—Å–º—ã—Å–ª–æ–≤:

* `link_order_customer` ‚Äî ¬´—ç—Ç–æ—Ç –∑–∞–∫–∞–∑ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —ç—Ç–æ–º—É –∫–ª–∏–µ–Ω—Ç—É¬ª;
* `link_contract_account` ‚Äî ¬´—ç—Ç–æ—Ç –¥–æ–≥–æ–≤–æ—Ä –ø—Ä–∏–≤—è–∑–∞–Ω –∫ —ç—Ç–æ–º—É —Å—á—ë—Ç—É¬ª.

DDL-–ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ:

```sql
CREATE TABLE link_order_customer (
    hk_order_customer  BYTEA PRIMARY KEY,
    hk_order           BYTEA NOT NULL,
    hk_customer        BYTEA NOT NULL,
    record_source      VARCHAR(50) NOT NULL,
    load_dttm          TIMESTAMP   NOT NULL
);
```

### 3.3. Satellite ‚Äî –∞—Ç—Ä–∏–±—É—Ç—ã –∏ –∏—Å—Ç–æ—Ä–∏—è

**Satellite** —Ö—Ä–∞–Ω–∏—Ç:

* –∞—Ç—Ä–∏–±—É—Ç—ã —Ö–∞–±–∞ –∏–ª–∏ –ª–∏–Ω–∫–∞;
* –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π —ç—Ç–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤.

–ü—Ä–∏–º–µ—Ä—ã:

* `sat_customer_info` ‚Äî –∏–º—è, email, –≥–æ—Ä–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞;
* `sat_customer_segment` ‚Äî —Å–µ–≥–º–µ–Ω—Ç, –∫–∞—Ç–µ–≥–æ—Ä–∏—è, —Ä–∏—Å–∫-–ø—Ä–æ—Ñ–∏–ª—å;
* `sat_order_status` ‚Äî —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞.

–¢–∏–ø–∏—á–Ω—ã–µ –ø–æ–ª—è:

* —Å—Å—ã–ª–∫–∞ –Ω–∞ HUB/LINK (`hk_customer`, `hk_order_customer`);
* –∞—Ç—Ä–∏–±—É—Ç—ã (email, city, status‚Ä¶);
* `valid_from` / `valid_to` ‚Äî –ø–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è –≤–µ—Ä—Å–∏–∏;
* `hashdiff` ‚Äî —Ö—ç—à –æ—Ç –≤—Å–µ—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (—á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å, —á—Ç–æ —Å—Ç—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å, –∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä–∏–ª–∞—Å—å);
* `record_source`, `load_dttm`.

```sql
CREATE TABLE sat_customer_info (
    hk_customer    BYTEA      NOT NULL,
    hashdiff       BYTEA      NOT NULL,
    valid_from     TIMESTAMP  NOT NULL,
    valid_to       TIMESTAMP  NOT NULL,
    name           VARCHAR(100),
    email          VARCHAR(100),
    city           VARCHAR(50),
    record_source  VARCHAR(50) NOT NULL,
    load_dttm      TIMESTAMP   NOT NULL
);
```

---

## 4. –¢–∏–ø—ã —Å–∞—Ç–µ–ª–ª–∏—Ç–æ–≤ –≤ DV 2.0

–í DV 2.0 –ø–æ—è–≤–∏–ª–æ—Å—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ ¬´—Ä–æ–ª—è–º¬ª —Å–∞—Ç–µ–ª–ª–∏—Ç–æ–≤. –ì–ª–∞–≤–Ω–æ–µ, —á—Ç–æ —Å—Ç–æ–∏—Ç –∑–Ω–∞—Ç—å:

* **Descriptive Satellites** ‚Äî –æ–±—ã—á–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã (–∏–º—è, –∞–¥—Ä–µ—Å, —Ç–∞—Ä–∏—Ñ) —Å –∏—Å—Ç–æ—Ä–∏–µ–π.
* **Effectivity Satellites** ‚Äî —Ñ–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–∏–æ–¥–∞—Ö –¥–µ–π—Å—Ç–≤–∏—è (`valid_from/valid_to`), –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–µ –Ω–∞ SCD2.
* **Multi-Active Satellites** ‚Äî –∫–æ–≥–¥–∞ —É —Å—É—â–Ω–æ—Å—Ç–∏ **–Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö** –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç—Ä–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞).
* **Transactional Satellites** ‚Äî —Å–æ–±—ã—Ç–∏—è, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –æ–¥–Ω–æ–º—É —Ö–∞–±—É/–ª–∏–Ω–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∂—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–∞).

–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ DDL-¬´—à–∞–±–ª–æ–Ω—ã¬ª –ø–æ–≤–µ—Ä—Ö –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –∏–¥–µ–∏:
**–∞—Ç—Ä–∏–±—É—Ç—ã + –≤—Ä–µ–º—è ‚Üí –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—á–∫–∞.**

---

## 5. Raw Vault vs Business Vault: ¬´—Å–∫–ª–∞–¥ –¥–µ—Ç–∞–ª–µ–π¬ª –∏ ¬´—Å–±–æ—Ä–æ—á–Ω—ã–π —Ü–µ—Ö¬ª

–û–±—ã—á–Ω–æ –ø–æ–¥ ¬´Data Vault¬ª –ª—é–¥–∏ —Å–º–µ—à–∏–≤–∞—é—Ç –¥–≤–∞ —Å–ª–æ—è:

```mermaid
flowchart LR
    SRC[–ò—Å—Ç–æ—á–Ω–∏–∫–∏] --> STG[STG / ODS]
    STG --> RAW[Raw Vault<br/>Hubs, Links, Sats]
    RAW --> BV[Business Vault<br/>PIT, Bridge, Derived]
    BV --> DM[Data Marts<br/>Star Schema]
    DM --> BI[BI / reports / ML]
````

* **Raw Vault** ‚Äî —ç—Ç–æ *–ø—Ä–æ –ø—Ä–∏—ë–º –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ* –¥–∞–Ω–Ω—ã—Ö ¬´–∫–∞–∫ –µ—Å—Ç—å¬ª, –Ω–æ –≤ —Ñ–æ—Ä–º–µ Hub/Link/Sat.
* **Business Vault** ‚Äî —ç—Ç–æ *–ø—Ä–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∏—Ö –≤ ¬´–¥–µ–ª–æ–≤–æ–π¬ª –≤–∏–¥*: —Å –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞–º–∏, PIT/Bridge –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è–º–∏.

### 5.1. Raw Vault ‚Äî ¬´–≤—Å—ë –ø—Ä–∏–ª–µ—Ç–µ–≤—à–µ–µ, –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Ä–∞–∑–ª–æ–∂–µ–Ω–Ω–æ–µ –ø–æ —è—â–∏—á–∫–∞–º¬ª

**Raw DV** ‚Äî –ø–µ—Ä–≤—ã–π —Å–ª–æ–π –ø–æ–≤–µ—Ä—Ö STG/ODS:

* –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∫–ª—é—á–∏;
* —Ä–∞–∑–±–∏—Ä–∞–µ–º —Å—É—â–Ω–æ—Å—Ç–∏ –ø–æ Hub/Link/Sat;
* —Å–æ—Ö—Ä–∞–Ω—è–µ–º *–≤—Å—é* –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–µ —Ä–µ—à–∞—è –µ—â—ë ¬´—á—Ç–æ —Ç–∞–∫–æ–µ –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∏–µ–Ω—Ç¬ª –∏–ª–∏ ¬´—É—Å–ø–µ—à–Ω—ã–π –∑–∞–∫–∞–∑¬ª.

–•–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–µ —á–µ—Ä—Ç—ã Raw Vault:

* –º–∏–Ω–∏–º—É–º –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏:
  –Ω–∏–∫–∞–∫–∏—Ö ¬´–∫–ª–∏–µ–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω, –µ—Å–ª–∏ –±—ã–ª–æ ‚â•1 –ø–æ–∫—É–ø–∫–∏ –∑–∞ 90 –¥–Ω–µ–π¬ª;
* –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è ¬´–∫–∞–∫ –µ—Å—Ç—å¬ª, —Ç–æ–ª—å–∫–æ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –æ–±—â–∏–º –∫–ª—é—á–∞–º;
* —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞: –¥–æ–±–∞–≤–∏–ª—Å—è –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Üí –ø–æ—è–≤–∏–ª—Å—è –Ω–æ–≤—ã–π Sat –∫ —Ç–æ–º—É –∂–µ Hub.

–≠—Ç–æ —Å–ª–æ–π **–¥–ª—è –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤**. –ü–∏—Å–∞—Ç—å –ø–æ –Ω–µ–º—É –æ—Ç—á—ë—Ç—ã ‚Äî –±–æ–ª—å–Ω–æ:

* —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å ¬´–∫–∞–∫–æ–π —É –∫–ª–∏–µ–Ω—Ç–∞ email –Ω–∞ –¥–∞—Ç—É –∑–∞–∫–∞–∑–∞¬ª, –Ω—É–∂–Ω–æ JOIN‚Äô–∏—Ç—å Hub + Sat + Link, –ø–ª—é—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ `valid_from/valid_to` –∏–ª–∏ `load_dttm`;
* —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å ¬´–ø–æ—Ä—Ç—Ä–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞¬ª ‚Äî –Ω—É–∂–Ω–æ —Ä—É–∫–∞–º–∏ –∫–ª–µ–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–∞—Ç–µ–ª–ª–∏—Ç–æ–≤.

–ü–æ—ç—Ç–æ–º—É **Raw DV –ø–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤**.

---

### 5.2. Business Vault ‚Äî ¬´—Ç–∞–º, –≥–¥–µ –∏–∑ Lego —Å–æ–±–∏—Ä–∞—é—Ç –º–æ–¥—É–ª–∏¬ª

**Business Vault (BV)** ‚Äî —ç—Ç–æ —Å–ª–æ–π –ø–æ–≤–µ—Ä—Ö Raw DV, –≥–¥–µ:

* –ø–æ—è–≤–ª—è—é—Ç—Å—è **–±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**,
* —Å—Ç—Ä–æ—è—Ç—Å—è —É–¥–æ–±–Ω—ã–µ –¥–ª—è —á—Ç–µ–Ω–∏—è **¬´—Å–±–æ—Ä–Ω—ã–µ¬ª –æ–±—ä–µ–∫—Ç—ã** (—Ç–∞–±–ª–∏—Ü—ã –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è),
* —É–ø—Ä–æ—â–∞–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø –∫ –∏—Å—Ç–æ—Ä–∏–∏.

–ö—Ç–æ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª—å BV:

* —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∏—Ç—Ä–∏–Ω (DM / Star Schema);
* —á–∞—Å—Ç—å —Å–ª–æ–∂–Ω—ã—Ö –æ—Ç—á—ë—Ç–æ–≤ (–æ—Å–æ–±–µ–Ω–Ω–æ —Å —Ç—è–∂—ë–ª–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π);
* –∏–Ω–æ–≥–¥–∞ ‚Äî data scientists, –µ—Å–ª–∏ –∏–º –Ω—É–∂–µ–Ω –±–æ–≥–∞—Ç—ã–π, –Ω–æ –µ—â—ë –Ω–µ ¬´—Å–ø–ª—é—â–µ–Ω–Ω—ã–π¬ª —Å–ª–æ–π.

–í BV –∂–∏–≤—É—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–∏—á–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.

#### 5.2.1. PIT-—Ç–∞–±–ª–∏—Ü—ã (Point-in-Time)

**PIT (Point-in-Time)** ‚Äî —Ç–∞–±–ª–∏—Ü—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–≤–µ—á–∞—é—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å:

> ¬´–ö–∞–∫ –≤—ã–≥–ª—è–¥–µ–ª –æ–±—ä–µ–∫—Ç *–Ω–∞ –¥–∞—Ç—É X*?¬ª

–í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø–∏—Å–∞—Ç—å —Å–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏ (`valid_from/valid_to`), –º—ã –∑–∞—Ä–∞–Ω–µ–µ –≥–æ—Ç–æ–≤–∏–º —Ç–∞–±–ª–∏—Ü—É:

```sql
CREATE TABLE pit_customer_daily (
    hk_customer   BYTEA,
    as_of_date    DATE,
    hk_sat_info   BYTEA,   -- —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω—É–∂–Ω—É—é –≤–µ—Ä—Å–∏—é sat_customer_info
    hk_sat_segment BYTEA,  -- —Å—Å—ã–ª–∫–∞ –Ω–∞ –Ω—É–∂–Ω—É—é –≤–µ—Ä—Å–∏—é sat_customer_segment
    ...
    load_dttm     TIMESTAMP
);
```

–¢–µ–ø–µ—Ä—å, —á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –≤–∏—Ç—Ä–∏–Ω—É –ø—Ä–æ–¥–∞–∂:

* JOIN `fact_orders` –∫ `pit_customer_daily` –ø–æ `order_date = as_of_date`;
* –∞ —É–∂–µ –ø–æ—Ç–æ–º ‚Äî –∫ —Å–∞—Ç–µ–ª–ª–∏—Ç–∞–º –ø–æ –∏—Ö –∫–ª—é—á–∞–º.

–í—ã–∏–≥—Ä—ã—à:

* —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ ¬´–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ω–∞ –¥–∞—Ç—É¬ª –∂–∏–≤—ë—Ç –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (ETL PIT);
* BI –∏ –≤–∏—Ç—Ä–∏–Ω—ã –≤–∏–¥—è—Ç ¬´–ø–æ—á—Ç–∏ –ø–ª–æ—Å–∫–∏–π¬ª —Å–ª–æ–π.

#### 5.2.2. Bridge-—Ç–∞–±–ª–∏—Ü—ã

**Bridge** ‚Äî —ç—Ç–æ ¬´–≥–æ—Ç–æ–≤—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã¬ª –ø–æ –≥—Ä–∞—Ñ—É Hub/Link.

–ù–∞–ø—Ä–∏–º–µ—Ä:

* –≤ DV –∫–ª–∏–µ–Ω—Ç ‚Üî –¥–æ–≥–æ–≤–æ—Ä ‚Üî —Å—á—ë—Ç ‚Üî –ø—Ä–æ–¥—É–∫—Ç –∂–∏–≤—É—Ç –≤ —Ä–∞–∑–Ω—ã—Ö —Ö–∞–±–∞—Ö/–ª–∏–Ω–∫–∞—Ö;
* —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–µ JOIN‚Äô–∏—Ç—å –≤–µ—Å—å –ø—É—Ç—å, –º—ã —Å—Ç—Ä–æ–∏–º `bridge_customer_account`:

```sql
CREATE TABLE bridge_customer_account AS
SELECT DISTINCT
    hk_customer,
    hk_account,
    first_seen_dttm,
    last_seen_dttm
FROM ...
```

Bridge:

* —É–ø—Ä–æ—â–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤–∏—Ç—Ä–∏–Ω;
* —Ñ–∏–∫—Å–∏—Ä—É—é—Ç —Å–ª–æ–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Å–≤—è–∑–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ —Å—á–∏—Ç–∞—Ç—å ¬´—Ç–µ–∫—É—â–∏–º¬ª —Å—á—ë—Ç–æ–º –∫–ª–∏–µ–Ω—Ç–∞).

#### 5.2.3. Business-–ø—Ä–∞–≤–∏–ª–∞ –∏ derived-—Ç–∞–±–ª–∏—Ü—ã

–í BV –ª–æ–≥–∏—á–Ω–æ —Ä–∞–∑–º–µ—â–∞—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è:

* **–ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è** –≤–æ –º–Ω–æ–≥–∏—Ö –æ—Ç—á—ë—Ç–∞—Ö;
* **—Å—Ç–∞–±–∏–ª—å–Ω–∞** –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–∏—Ç—Ä–∏–Ω—ã.

–ü—Ä–∏–º–µ—Ä—ã:

* ¬´–ê–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∏–µ–Ω—Ç¬ª ‚Äî —Ñ–ª–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ Raw DV (–∏—Å—Ç–æ—Ä–∏–∏ –ø–æ–∫—É–ø–æ–∫, –ª–æ–≥–∏–Ω–æ–≤ –∏ —Ç.–ø.);
* ¬´–û—Å–Ω–æ–≤–Ω–æ–π —Ç–∞—Ä–∏—Ñ¬ª ‚Äî –≤—ã–±—Ä–∞–Ω –ø–æ –Ω–∞–±–æ—Ä—É –ø—Ä–∞–≤–∏–ª –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤;
* ¬´–ß–∏—Å—Ç—ã–π —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞¬ª ‚Äî —Å–≤—ë—Ä–Ω—É—Ç –∏–∑ —Ü–µ–ø–æ—á–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤ (created ‚Üí paid ‚Üí shipped ‚Üí delivered / cancelled).

–≠—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ Sats/Links, —Ç–∞–∫ –∏ ¬´–ª–æ–≥–∏—á–µ—Å–∫–∏–µ¬ª —Ç–∞–±–ª–∏—Ü—ã BV:

```sql
CREATE TABLE bv_customer_flags AS
SELECT
    hk_customer,
    is_active_30d,
    is_active_90d,
    is_vip,
    load_dttm
FROM ...
```

–ü–æ—Ç–æ–º –≤–∏—Ç—Ä–∏–Ω—ã –±–µ—Ä—É—Ç —É–∂–µ –≥–æ—Ç–æ–≤—ã–µ —Ñ–ª–∞–≥–∏, –Ω–µ –¥—É–±–ª–∏—Ä—É—è –ø—Ä–∞–≤–∏–ª–∞.

---

### 5.3. –ì—Ä–∞–Ω–∏—Ü–∞ –º–µ–∂–¥—É Business Vault –∏ –≤–∏—Ç—Ä–∏–Ω–∞–º–∏ (DM)

–í–∞–∂–Ω–æ –Ω–µ —Å–∫–∞—Ç–∏—Ç—å—Å—è –≤ –¥–≤–µ –∫—Ä–∞–π–Ω–æ—Å—Ç–∏:

* –≤—Å—ë —Ç–∞—â–∏—Ç—å –≤ Raw DV ‚Üí BV –ø—É—Å—Ç–æ–π, –≤–∏—Ç—Ä–∏–Ω—ã –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω—ã –ª–æ–≥–∏–∫–æ–π;
* –≤—Å—ë —Ç–∞—â–∏—Ç—å –≤ BV ‚Üí –≤–∏—Ç—Ä–∏–Ω—ã –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ —Ç–æ–Ω–∫–∏–π —Å–ª–æ–π SELECT‚Äô–æ–≤, –Ω–æ BV ‚Äî –Ω–æ–≤—ã–π ¬´–º–æ–Ω–æ–ª–∏—Ç¬ª.

–ü–æ–ª–µ–∑–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ:

> **–í Business Vault –∂–∏–≤—ë—Ç —Ç–æ, —á—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –±–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç—è–º –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è.
> –í –≤–∏—Ç—Ä–∏–Ω–∞—Ö –∂–∏–≤—ë—Ç —Ç–æ, —á—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞/–¥–∞—à–±–æ—Ä–¥–∞.**

–ù–∞–ø—Ä–∏–º–µ—Ä:

* ¬´–∫–ª–∏–µ–Ω—Ç –∞–∫—Ç–∏–≤–µ–Ω, –µ—Å–ª–∏ ‚â•1 –ø–æ–∫—É–ø–∫–∏ –∑–∞ 90 –¥–Ω–µ–π¬ª ‚Äî —ç—Ç–æ –ª–æ–≥–∏–∫–∞ —É—Ä–æ–≤–Ω—è –∫–ª–∏–µ–Ω—Ç–∞ ‚Üí –º–µ—Å—Ç–æ –µ–π –≤ BV (`bv_customer_flags`);
* ¬´–∫–ª–∏–µ–Ω—Ç –ø–æ–ø–∞–ª –≤ —ç—Ç—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—É—é –≤–æ—Ä–æ–Ω–∫—É¬ª ‚Äî —ç—Ç–æ –ª–æ–≥–∏–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ—Ç—á—ë—Ç–∞ ‚Üí –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –≤ DM.

---

### 5.4. –ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å–≤—è–∑–∫–∞ Raw DV ‚Üí BV ‚Üí DM –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ

–í–æ–∑—å–º—ë–º –ø—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞:

1. **Raw Vault**:

   * `hub_customer`, `hub_order`;
   * `link_order_customer`;
   * `sat_customer_info`, `sat_order_status`, `sat_customer_segment`.

2. **Business Vault**:

   * `pit_customer_daily` ‚Äî ¬´—Å—Ä–µ–∑ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –¥–Ω—è–º¬ª;
   * `bv_customer_flags` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å, VIP-—Å—Ç–∞—Ç—É—Å—ã, —Å–µ–≥–º–µ–Ω—Ç—ã;
   * `bridge_customer_order` ‚Äî —Å–≤—è–∑–∏ –∫–ª–∏–µ–Ω—Ç ‚Üî –∑–∞–∫–∞–∑ —Å —É–¥–æ–±–Ω—ã–º–∏ –∫–ª—é—á–∞–º–∏.

3. **DM / Star Schema**:

   * `dm.fact_sales` ‚Äî —Ñ–∞–∫—Ç –ø—Ä–æ–¥–∞–∂;
   * `dm.dim_customer` ‚Äî —É–∂–µ ¬´–ø–ª–æ—Å–∫–æ–µ¬ª –∏–∑–º–µ—Ä–µ–Ω–∏–µ —Å –Ω—É–∂–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ (`email_current`, `segment`, `is_active_90d`‚Ä¶);
   * `dm.dim_date`, `dm.dim_product` –∏ —Ç.–ø.

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ:

* **Raw DV** ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, –∏—Å—Ç–æ—Ä–∏—á–Ω—ã–π –∏ –Ω–µ–∫—Ä–∞—Å–∏–≤—ã–π;
* **BV** ‚Äî ¬´—Ä–∞–±–æ—á–∏–π —Å–ª–æ–π –¥–ª—è –∏–Ω–∂–µ–Ω–µ—Ä–æ–≤ –∏ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤¬ª;
* **DM** ‚Äî –ø—Ä–∏–≤—ã—á–Ω–∞—è –ó–≤–µ–∑–¥–∞ –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö.

---

–ö—Ä–∞—Ç–∫–æ:

* Raw DV –±–µ–∑ BV ‚Äî —ç—Ç–æ –∫–∞–∫ –¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `hub_*/link_*/sat_*` –∏ –∑–∞—Å—Ç–∞–≤–ª—è—Ç—å –≤—Å–µ—Ö –ø–∏—Å–∞—Ç—å –ø–æ–≤–µ—Ä—Ö –Ω–∏—Ö –∑–∞–ø—Ä–æ—Å—ã. –≠—Ç–æ –±–æ–ª—å–Ω–æ.
* **Business Vault ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π —Å–ª–æ–π**, –µ—Å–ª–∏ –≤—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∂–∏–≤—ë—Ç–µ –≤ Data Vault, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ ¬´—Å–ª–æ–∂–∏–ª–∏ –∏—Å—Ç–æ—Ä–∏—é –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É Hub/Link/Sat¬ª.

---

## 6. –ü—Ä–∏–º–µ—Ä: –∫–ª–∏–µ–Ω—Ç –∏ –∑–∞–∫–∞–∑—ã –≤ DV-—Å—Ç–∏–ª–µ

–í–æ–∑—å–º—ë–º –º–∏–Ω–∏-–ø—Ä–∏–º–µ—Ä (—Ç–æ—Ç –∂–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω):

* –∫–ª–∏–µ–Ω—Ç —Å `customer_id = 101` –∏ –º–µ–Ω—è—é—â–∏–º—Å—è email;
* –∑–∞–∫–∞–∑—ã `order_id = 5001, 5002`;
* —Å—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤.

–í Data Vault:

* `hub_customer` ‚Äî –æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –Ω–∞ BK `101`;
* `sat_customer_info` ‚Äî –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –ø–æ –º–µ—Ä–µ —Å–º–µ–Ω—ã email/–≥–æ—Ä–æ–¥–∞;
* `hub_order` ‚Äî –ø–æ —Å—Ç—Ä–æ–∫–µ –Ω–∞ –∫–∞–∂–¥—ã–π –∑–∞–∫–∞–∑;
* `link_order_customer` ‚Äî —Å–≤—è–∑—å –∑–∞–∫–∞–∑ ‚Üî –∫–ª–∏–µ–Ω—Ç;
* `sat_order_status` ‚Äî –∏—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞–∫–∞–∑–∞.

–î–∞–ª—å—à–µ:

* –∏–∑ Raw DV –º—ã —Å—Ç—Ä–æ–∏–º PIT:

  * ¬´–∫–∞–∫–∏–º –±—ã–ª –∫–ª–∏–µ–Ω—Ç –Ω–∞ –¥–∞—Ç—É –∑–∞–∫–∞–∑–∞?¬ª;
* –∏ —É–∂–µ –∏–∑ PIT + —Å—Å—ã–ª–æ–∫ —Å–æ–±–∏—Ä–∞–µ–º –≤–∏—Ç—Ä–∏–Ω—É `mart_sales` –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ó–≤–µ–∑–¥—ã.

–¢—É—Ç –≤–∞–∂–Ω–æ, —á—Ç–æ **Raw DV –ø–æ—á—Ç–∏ –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç—Å—è** –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ ‚Äî –ø—Ä–∞–≤–∏–º BV –∏ –≤–∏—Ç—Ä–∏–Ω—ã.

---

## 7. –ö–∞–∫ —ç—Ç–æ –∂–∏–≤—ë—Ç –≤ –ø–∞–π–ø–ª–∞–π–Ω–µ –∑–∞–≥—Ä—É–∑–∫–∏

–¢–∏–ø–∏—á–Ω—ã–π ETL/ELT —Å DV:

1. **STG/ODS**: –≤—ã—Ç–∞—â–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –ø–æ—á–∏—Å—Ç–∏–ª–∏ —Ç–∏–ø—ã, –ø—Ä–∏–≤–µ–ª–∏ —Ñ–æ—Ä–º–∞—Ç.
2. **Raw Vault**:

   * –ø–æ BK –≤—ã—á–∏—Å–ª–∏–ª–∏ —Ö—ç—à-–∫–ª—é—á–∏ –¥–ª—è Hubs;
   * —Å–æ–∑–¥–∞–ª–∏/–æ–±–Ω–æ–≤–∏–ª–∏ Hubs;
   * —Å–æ–∑–¥–∞–ª–∏/–æ–±–Ω–æ–≤–∏–ª–∏ Links;
   * —Å—Ä–∞–≤–Ω–∏–ª–∏ `hashdiff` –≤ Sats ‚Üí –¥–æ–±–∞–≤–∏–ª–∏ –Ω–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤.
3. **Business Vault**:

   * —Å–æ–±—Ä–∞–ª–∏ PIT-—Ç–∞–±–ª–∏—Ü—ã (–æ–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ –Ω–∞ –æ–±—ä–µ–∫—Ç –Ω–∞ –¥–∞—Ç—É X);
   * –¥–æ–±–∞–≤–∏–ª–∏ –±–∏–∑–Ω–µ—Å-—Ñ–ª–∞–≥–∏ –∏ derived-–ø–æ–ª—è.
4. **DM (Star)**:

   * –ø–æ—Å—Ç—Ä–æ–∏–ª–∏ —Ñ–∞–∫—Ç + –∏–∑–º–µ—Ä–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –ø–æ–¥—Ö–æ–¥—è—Ç BI/–∞–Ω–∞–ª–∏—Ç–∏–∫–∞–º.

–ó–∞ —Å—á—ë—Ç **—Ö—ç—à-–∫–ª—é—á–µ–π –∏ hashdiff** DV —Ö–æ—Ä–æ—à–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏—Ç—Å—è:
—Ä–∞–∑–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏ –¥–æ–º–µ–Ω—ã –º–æ–≥—É—Ç –≥—Ä—É–∑–∏—Ç—å—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞–º–∏.

---

## 8. –ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã Data Vault ‚Äî –±–µ–∑ —Ä–æ–º–∞–Ω—Ç–∏–∫–∏

### 8.1. –ü–ª—é—Å—ã

* üìú **–ò—Å—Ç–æ—Ä–∏—è ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª**
  –ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ —Å–∞—Ç–µ–ª–ª–∏—Ç–µ. –ù–∏—á–µ–≥–æ –Ω–µ –ø–µ—Ä–µ–∑–∞—Ç–∏—Ä–∞–µ—Ç—Å—è.

* üß© **–õ—ë–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤**
  –ù–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å —Ç–µ–º–∏ –∂–µ —Å—É—â–Ω–æ—Å—Ç—è–º–∏ = –Ω–æ–≤—ã–µ —Å–∞—Ç–µ–ª–ª–∏—Ç—ã –∫ —Ç–µ–º –∂–µ —Ö–∞–±–∞–º.

* üîé **–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∏ –∞—É–¥–∏—Ç**
  –í–∏–¥–Ω–æ, –∏–∑ –∫–∞–∫–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, –∫–æ–≥–¥–∞ –∏ —Å –∫–∞–∫–∏–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ –ø—Ä–∏–ª–µ—Ç–µ–ª–∞ –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞.

* üë• **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∫–æ–º–∞–Ω–¥**
  –†–∞–∑–Ω—ã–µ –¥–æ–º–µ–Ω—ã –≤ DV –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

### 8.2. –ú–∏–Ω—É—Å—ã

* üß† **–í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥ –≤—Ö–æ–¥–∞**
  –ù—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å SCD, —Ö—ç—à-–∫–ª—é—á–∏, –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ JOIN, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∑–∞–≥—Ä—É–∑–∫–∏.

* üìà **–ë–æ–ª—å—à–µ —Ç–∞–±–ª–∏—Ü –∏ JOIN‚Äô–æ–≤**
  –î–∞–∂–µ –ø—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ ¬´HUB + LINK + 2‚Äì3 SAT + PIT¬ª.

* üõ† **–ù—É–∂–Ω–∞ –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞**
  –ó–∞–±—ã–ª–∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å `record_source`/`load_dttm` ‚Äî –ø–æ—Ç–µ—Ä—è–ª–∏ —á–∞—Å—Ç—å –∞—É–¥–∏—Ç–∞.

* ‚è≥ **–ü–ª–æ—Ö–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è MVP**
  –î–ª—è 2‚Äì3 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ DV –æ–±—ã—á–Ω–æ –¥–æ—Ä–æ–∂–µ, —á–µ–º –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è 3NF/–ó–≤–µ–∑–¥–∞.

---

## 9. –ö–æ–≥–¥–∞ DV —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å, –∞ –∫–æ–≥–¥–∞ ‚Äî –Ω–µ—Ç

### –ü–æ–¥—Ö–æ–¥–∏—Ç, –µ—Å–ª–∏:

* —É –≤–∞—Å **–∑–æ–æ–ø–∞—Ä–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤** (5+ —Å–∏—Å—Ç–µ–º, –∫–æ—Ç–æ—Ä—ã–µ –µ—â—ë –∏ –º–µ–Ω—è—é—Ç—Å—è);
* –≤–∞–∂–Ω–∞ **–ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏ –∞—É–¥–∏—Ç** (—Ñ–∏–Ω—Ç–µ—Ö, –≥–æ—Å, —Ç–µ–ª–µ–∫–æ–º, –∫—Ä—É–ø–Ω—ã–π –±–∞–Ω–∫);
* –∫–æ–º–∞–Ω–¥–∞ –Ω–∞—Ü–µ–ª–µ–Ω–∞ –Ω–∞ –¥–æ–ª–≥—É—é –∂–∏–∑–Ω—å DWH, –∞ –Ω–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–π –æ—Ç—á—ë—Ç;
* –µ—Å—Ç—å –ª—é–¥–∏, –≥–æ—Ç–æ–≤—ã–µ –∂–∏—Ç—å –≤ —ç—Ç–æ–π –º–æ–¥–µ–ª–∏ (–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä, data engineer‚Äô—ã).

### –õ—É—á—à–µ –Ω–µ –Ω–∞—á–∏–Ω–∞—Ç—å —Å DV, –µ—Å–ª–∏:

* —ç—Ç–æ **–ø–µ—Ä–≤—ã–π DWH –≤ –∫–æ–º–ø–∞–Ω–∏–∏**;
* 1‚Äì3 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ –Ω–µ—Ç –∂—ë—Å—Ç–∫–∏—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –∞—É–¥–∏—Ç—É;
* –∫–æ–º–∞–Ω–¥–∞ –º–∞–ª–∞—è (1‚Äì2 –∏–Ω–∂–µ–Ω–µ—Ä–∞ + –∞–Ω–∞–ª–∏—Ç–∏–∫) –∏ —Å—Ä–æ–∫–∏ –∂–º—É—Ç;
* –∑–∞–¥–∞—á–∞ –∑–≤—É—á–∏—Ç –∫–∞–∫ ¬´–¥–∞–π—Ç–µ –æ—Ç—á—ë—Ç—ã –∫ –∫–≤–∞—Ä—Ç–∞–ª—É¬ª, –∞ –Ω–µ ¬´–ø–æ—Å—Ç—Ä–æ–∏–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –Ω–∞ 5 –ª–µ—Ç¬ª.

–í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —á–µ—Å—Ç–Ω–µ–µ (–∏ –¥–µ—à–µ–≤–ª–µ) –Ω–∞—á–∞—Ç—å —Å:

> `stg ‚Üí ods ‚Üí dds (3NF/–ø—Ä–æ—Å—Ç–∞—è –ó–≤–µ–∑–¥–∞ —Å SCD2) ‚Üí dm (–ó–≤–µ–∑–¥–∞)`

–ê DV –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥, –∫–æ–≥–¥–∞ –ø–æ—è–≤—è—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –±–æ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω —Ä–µ—à–∞–µ—Ç.

---

## 10. –ö–∞–∫ —É—á–∏—Ç—å Data Vault –¥–∞–ª—å—à–µ

–ï—Å–ª–∏ –ø–æ—Å–ª–µ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–∏ —Ö–æ—á–µ—Ç—Å—è ¬´–∫–æ–ø–Ω—É—Ç—å –≥–ª—É–±–∂–µ¬ª, –º–æ–∂–Ω–æ –∏–¥—Ç–∏ –ø–æ —Ç–∞–∫–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏:

1. **–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –±–∞–∑—É**:

   * —Å–ª–æ–∏ STG/ODS/DDS/DM;
   * —Ñ–∞–∫—Ç—ã/–∏–∑–º–µ—Ä–µ–Ω–∏—è;
   * SCD Type 2.

2. **–ü–æ—á–∏—Ç–∞—Ç—å/–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ DV 2.0**:

   * –∫–Ω–∏–≥–∏/–¥–æ–∫–∏ –õ–∏–Ω—Å—Ç–µ–¥—Ç–∞ (Dan Linstedt, *Data Vault 2.0*),
   * –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –¥–æ–∫–ª–∞–¥—ã (–æ—Å–æ–±–µ–Ω–Ω–æ –æ—Ç —Ç–µ–ª–µ–∫–æ–º–æ–≤ –∏ –±–∞–Ω–∫–æ–≤ ‚Äî —Ç–∞–º DV –∂–∏–≤–æ–π).

3. **–°–¥–µ–ª–∞—Ç—å –∏–≥—Ä—É—à–µ—á–Ω—ã–π DV-–ø—Ä–æ–µ–∫—Ç**:

   * –≤–∑—è—Ç—å —Ç–æ—Ç –∂–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω,
   * —Å–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å `hub_customer`, `hub_order`, `link_order_customer`, 2‚Äì3 —Å–∞—Ç–µ–ª–ª–∏—Ç–∞,
   * –Ω–∞–ø–∏—Å–∞—Ç—å –ø–∞—Ä—É –∑–∞–ø—Ä–æ—Å–æ–≤: ¬´–∫–∞–∫–æ–π –±—ã–ª –∫–ª–∏–µ–Ω—Ç –Ω–∞ –¥–∞—Ç—É –∑–∞–∫–∞–∑–∞?¬ª, ¬´–∫–∞–∫ –º–µ–Ω—è–ª—Å—è —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞?¬ª.

4. **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –≥–∏–±—Ä–∏–¥—ã**:

   * DV –≤ —è–¥—Ä–µ (Raw+Business Vault),
   * –ó–≤–µ–∑–¥–∞ –Ω–∞ –≤–∏—Ç—Ä–∏–Ω–∞—Ö.

