# **–•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö: –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ ¬´–ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º¬ª**  
*–î–ª—è —Ç–µ—Ö, –∫—Ç–æ –∑–Ω–∞–µ—Ç SQL, –Ω–æ —Ö–æ—á–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤ Excel, –∞ –ø–æ-–≤–∑—Ä–æ—Å–ª–æ–º—É*

---

## **–ß—Ç–æ –≤—ã —É–∂–µ —É–º–µ–µ—Ç–µ ‚Äî –∏ —á—Ç–æ —É–∑–Ω–∞–µ—Ç–µ –∑–¥–µ—Å—å**

‚úÖ –£–∂–µ –∑–Ω–∞–µ—Ç–µ:  
- `SELECT`, `JOIN`, `GROUP BY`;  
- –∫–∞–∫ –ø–æ—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º—É/—Å—Ä–µ–¥–Ω–µ–µ/–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ —Ç–∞–±–ª–∏—Ü–µ.

üÜï –£–∑–Ω–∞–µ—Ç–µ –≤ —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ:  
- **—Å–ª–æ–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞** (STG ‚Üí ODS ‚Üí DDS ‚Üí DM) –∏ *–∑–∞—á–µ–º –æ–Ω–∏ –Ω—É–∂–Ω—ã*;  
- **—Ñ–∞–∫—Ç—ã –∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è** ‚Äî –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–∏—Ä–ø–∏—á–∏–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏;  
- **SCD Type 2** ‚Äî –∫–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–º–µ–Ω—É email –∏–ª–∏ –≥–æ—Ä–æ–¥–∞);  
- **—Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ (SK)** –∏ —á–µ–º –æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç –æ–±—ã—á–Ω—ã—Ö `id`;  
- **—á–µ—Ç—ã—Ä–µ –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö**: 3NF, –ó–≤–µ–∑–¥–∞ (Star), Data Vault, Anchor Modeling ‚Äî –∏ –∫–æ–≥–¥–∞ –∫–∞–∫—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

‚õî **–ù–µ –±—É–¥–µ–º –≥–æ–≤–æ—Ä–∏—Ç—å** –∑–¥–µ—Å—å –æ:  
- —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —Ö—Ä–∞–Ω–µ–Ω–∏–∏ (–ø–∞—Ä—Ç–∏—Ü–∏–∏, –∏–Ω–¥–µ–∫—Å—ã, ClickHouse-–¥–≤–∏–∂–∫–∏);  
- —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö (Kafka, Spark, Airflow ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫—É—Ä—Å);  
- –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (`EXPLAIN`, –∫—ç—à–∏ –∏ —Ç.–ø.).  
–≠—Ç–æ ‚Äî –ø—Ä–æ *–ª–æ–≥–∏–∫—É*, —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ –∑–¥—Ä–∞–≤—ã–π —Å–º—ã—Å–ª.

---

## **1. –í–≤–µ–¥–µ–Ω–∏–µ: –ø–æ—á–µ–º—É –Ω–µ–ª—å–∑—è –ø—Ä–æ—Å—Ç–æ SELECT –∏–∑ –±–∞–∑—ã –∑–∞–∫–∞–∑–æ–≤?**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ: –≤—ã ‚Äî –∞–Ω–∞–ª–∏—Ç–∏–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ. –í–∞–º –Ω—É–∂–Ω–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å:  
> **¬´–°–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤ —Å–¥–µ–ª–∞–ª –∫–ª–∏–µ–Ω—Ç —Å email `a@ex.com` –∑–∞ 2023 –≥–æ–¥, –∏ —Å–∫–æ–ª—å–∫–æ –æ–Ω –ø–æ—Ç—Ä–∞—Ç–∏–ª?¬ª**

–í—ã –∏–¥—ë—Ç–µ –≤ –±–∞–∑—É –∑–∞–∫–∞–∑–æ–≤ ‚Äî –∏‚Ä¶ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç–µ email. –û–Ω –≤ CRM. –ò–¥—ë—Ç–µ –≤ CRM ‚Äî —Ç–∞–º –Ω–µ—Ç —Å—É–º–º –∑–∞–∫–∞–∑–æ–≤. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç–µ—Å—å –≤ –∑–∞–∫–∞–∑—ã ‚Äî —Å—É–º–º–∞ –µ—Å—Ç—å, –Ω–æ *—Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞*. –ê –≤ 2023 –≥–æ–¥—É —Ü–µ–Ω–∞ –±—ã–ª–∞ –¥—Ä—É–≥–æ–π!

–ó–Ω–∞–∫–æ–º–æ? –≠—Ç–æ ‚Äî **–ø—Ä–æ–±–ª–µ–º–∞ OLTP-—Å–∏—Å—Ç–µ–º** (–æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —É—á—ë—Ç–∞):  
- **CRM**, **—Å–∫–ª–∞–¥**, **–ø–ª–∞—Ç—ë–∂–∫–∞** ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω—ã–µ –±–∞–∑—ã;  
- –∫–∞–∂–¥–∞—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ *–±—ã—Å—Ç—Ä—É—é –∑–∞–ø–∏—Å—å –æ–ø–µ—Ä–∞—Ü–∏–π* (¬´–¥–æ–±–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑¬ª, ¬´—Å–ø–∏—Å–∞—Ç—å —Ç–æ–≤–∞—Ä¬ª);  
- –∏—Å—Ç–æ—Ä–∏—é —Ç–∞–º –Ω–µ —Ö—Ä–∞–Ω—è—Ç ‚Äî email –º–µ–Ω—è–µ—Ç—Å—è ¬´–≤ –ª–æ–±¬ª: —Å—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è.

–¢–∞–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã –Ω–∞–∑—ã–≤–∞—é—Ç **OLTP** (*Online Transaction Processing* ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏).  
–ê –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –Ω—É–∂–Ω–∞ **OLAP** (*Online Analytical Processing* ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –∞–Ω–∞–ª–∏–∑).

‚û°Ô∏è **–•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (Data Warehouse, DWH)** ‚Äî —ç—Ç–æ –∫–∞–∫ ¬´–µ–¥–∏–Ω–∞—è –∫–∞—Ä—Ç–∞ —Å–æ–∫—Ä–æ–≤–∏—â¬ª, –∫—É–¥–∞ —Å–æ–±–∏—Ä–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, *—Å–æ—Ö—Ä–∞–Ω—è—è –∏—Å—Ç–æ—Ä–∏—é*, *–≤—ã—Ä–∞–≤–Ω–∏–≤–∞—è —Ç–µ—Ä–º–∏–Ω—ã* –∏ *–≥–æ—Ç–æ–≤—è –∏—Ö –∫ –∞–Ω–∞–ª–∏–∑—É*.

–ò –≤–æ—Ç –≥–ª–∞–≤–Ω—ã–π —Å–µ–∫—Ä–µ—Ç –µ–≥–æ —É—Å–ø–µ—Ö–∞: **—Å–ª–æ–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**.

---

## **2. –£—á–µ–±–Ω—ã–π –ø—Ä–∏–º–µ—Ä: –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω**

–ß—Ç–æ–±—ã –≤—Å—ë –±—ã–ª–æ –Ω–∞ –ø–∞–ª—å—Ü–∞—Ö ‚Äî —Ä–∞–∑–±–µ—Ä—ë–º –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ –∂–∏–≤–æ–π –ø—Ä–∏–º–µ—Ä.

–£ –Ω–∞—Å –µ—Å—Ç—å 6 —Ç–∞–±–ª–∏—Ü –∏–∑ —Ç—Ä—ë—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:

| –¢–∞–±–ª–∏—Ü–∞ | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ß—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç |
|---------|----------|--------------|
| `customers` | CRM | –ö–ª–∏–µ–Ω—Ç—ã: `customer_id`, `email`, `phone`, `city` |
| `orders`, `order_items` | –ó–∞–∫–∞–∑—ã | –ó–∞–∫–∞–∑—ã –∏ –ø–æ–∑–∏—Ü–∏–∏ –≤ –Ω–∏—Ö |
| `products` | –°–∫–ª–∞–¥ | –¢–æ–≤–∞—Ä—ã: `product_id`, `name` |
| `prices` | –°–∫–ª–∞–¥ | –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω: `product_id`, `valid_from`, `valid_to`, `price` |
| `promos` | –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥ | –ê–∫—Ü–∏–∏: `promo_id`, `code` |

‚ö†Ô∏è –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ:  
- `customer_id = 101` –≤ –æ–¥–Ω–æ–º –º–µ—Å—è—Ü–µ ‚Äî `a@ex.com`, –≤ –¥—Ä—É–≥–æ–º ‚Äî `b@ex.com`;  
- —Ü–µ–Ω–∞ –Ω–∞ —Ç–æ–≤–∞—Ä `9001` (Phone) –≤ —è–Ω–≤–∞—Ä–µ ‚Äî 100 ‚ÇΩ, –≤ —Ñ–µ–≤—Ä–∞–ª–µ ‚Äî 110 ‚ÇΩ;  
- `order_items` —Å–æ–¥–µ—Ä–∂–∏—Ç `price_at_sale` ‚Äî *—Ü–µ–Ω—É –≤ –º–æ–º–µ–Ω—Ç –ø–æ–∫—É–ø–∫–∏*, –∞ –Ω–µ —Ç–µ–∫—É—â—É—é.

–≠—Ç–æ —É–∂–µ **–Ω–∞–º—ë–∫**: —á—Ç–æ–±—ã –ø–æ—Å—á–∏—Ç–∞—Ç—å –≤—ã—Ä—É—á–∫—É 2023 –≥–æ–¥–∞, –Ω–∞–º –Ω—É–∂–Ω–∞ –Ω–µ —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞, –∞ *—Ç–∞, —á—Ç–æ –±—ã–ª–∞ –≤ –¥–µ–Ω—å –∑–∞–∫–∞–∑–∞*.

(ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ –∏ DDL-–ø—Ä–∏–º–µ—Ä—ã ‚Äî –≤ –∫–æ–Ω—Ü–µ —Å—Ç–∞—Ç—å–∏, –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–î–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏¬ª.)

---

## **3. –ó–∞—á–µ–º –¥–µ–ª–∏—Ç—å DWH –Ω–∞ —Å–ª–æ–∏?**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —Å—Ç—Ä–æ–∏—Ç–µ –¥–æ–º. –í—ã –∂–µ –Ω–µ –±—É–¥–µ—Ç–µ —Å—Ä–∞–∑—É –≤–±–∏–≤–∞—Ç—å –≥–≤–æ–∑–¥–∏ –≤ —Å—Ç–µ–Ω—ã ‚Äî —Å–Ω–∞—á–∞–ª–∞:  
1. –ü—Ä–∏–≤–µ–∑–ª–∏ —Å—Ç—Ä–æ–π–º–∞—Ç–µ—Ä–∏–∞–ª—ã (–ø–µ—Å–æ–∫, –¥–æ—Å–∫–∏, –∫–∏—Ä–ø–∏—á) ‚Äî **—Å—ã—Ä—å—ë**;  
2. –û—á–∏—Å—Ç–∏–ª–∏, –ø—Ä–æ—Å–µ—è–ª–∏, –Ω–∞—Ä–µ–∑–∞–ª–∏ ‚Äî **–æ–±—Ä–∞–±–æ—Ç–∫–∞**;  
3. –°–æ–±—Ä–∞–ª–∏ –∫–∞—Ä–∫–∞—Å, –ø—Ä–æ–≤–µ–ª–∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ ‚Äî **–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**;  
4. –°–¥–µ–ª–∞–ª–∏ –æ—Ç–¥–µ–ª–∫—É –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∫–≤–∞—Ä—Ç–∏—Ä—É ‚Äî **–≥–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ**.

–í DWH ‚Äî —Ç–æ –∂–µ —Å–∞–º–æ–µ. –ö–∞–∂–¥—ã–π —Å–ª–æ–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ *–æ–¥–Ω—É –∑–∞–¥–∞—á—É*:

```mermaid
flowchart TD
    subgraph Sources["–ò—Å—Ç–æ—á–Ω–∏–∫–∏"]
        A["CRM"]
        B["–ó–∞–∫–∞–∑—ã"]
        C["–°–∫–ª–∞–¥"]
    end

    subgraph STG["STG ‚Äî ¬´–°—ã—Ä—å—ë¬ª"]
        D["–¢–∞–±–ª–∏—Ü—ã-–¥—É–±–ª–∏–∫–∞—Ç—ã</br>–≤ —Ñ–æ—Ä–º–∞—Ç–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞"]
    end

    subgraph ODS["ODS ‚Äî ¬´–û—á–∏—Å—Ç–∫–∞¬ª"]
        E["–¢–∏–ø—ã:</br>–¥–∞—Ç—ã ‚Üí DATE,</br>—á–∏—Å–ª–∞ ‚Üí INT/DECIMAL</br>–í–∞–ª–∏–¥–∞—Ü–∏—è: email, phone"]
    end

    subgraph DDS["DDS ‚Äî ¬´–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è¬ª"]
        F["–û–±—â–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏:</br>–∫–ª–∏–µ–Ω—Ç, —Ç–æ–≤–∞—Ä, –¥–∞—Ç–∞</br>–ò—Å—Ç–æ—Ä–∏—è (SCD),</br>—Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏"]
    end

    subgraph DM["DM ‚Äî ¬´–ì–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è¬ª"]
        G["–í–∏—Ç—Ä–∏–Ω–∞ –ø—Ä–æ–¥–∞–∂: –¥–∞—Ç–∞, —Ç–æ–≤–∞—Ä, –∫–ª–∏–µ–Ω—Ç, —Å—É–º–º–∞</br>+ –∞–≥—Ä–µ–≥–∞—Ç—ã (–≤—ã—Ä—É—á–∫–∞/–¥–µ–Ω—å)"]
    end

    A --> STG
    B --> STG
    C --> STG

    STG --> ODS
    ODS --> DDS
    DDS --> DM
    DM --> BI["BI-—Å–∏—Å—Ç–µ–º—ã</br>(Power BI, Tableau,</br>Metabase)"]
```

üëâ **–ü–æ—á–µ–º—É —Ç–∞–∫ –ª—É—á—à–µ, —á–µ–º ¬´–æ–¥–Ω–∞ –±–æ–ª—å—à–∞—è —Ç–∞–±–ª–∏—Ü–∞¬ª?**  
1. **–£–ø—Ä–∞–≤–ª—è–µ–º–æ—Å—Ç—å**: –µ—Å–ª–∏ –≤ `customers` –ø—Ä–∏—à—ë–ª –±–∏—Ç—ã–π `email` ‚Äî –æ—à–∏–±–∫–∞ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ STG/ODS, DDS –Ω–µ –ø–æ—Å—Ç—Ä–∞–¥–∞–µ—Ç.  
2. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å: ¬´–∞ –∫–∞–∫ –≤—ã–≥–ª—è–¥–µ–ª –∏—Å—Ö–æ–¥–Ω–∏–∫?¬ª, ¬´–∞ –∫–∞–∫ –º—ã –µ–≥–æ –ø–æ—á–∏—Å—Ç–∏–ª–∏?¬ª.  
3. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –≤ DDS –∏ DM ‚Äî —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –ù–∏–∫–∞–∫–∏—Ö `JSON`-–ø–æ–ª–µ–π, `TEXT` –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã.

---

## **4. –ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö: –æ—Ç STG –¥–æ DM**

–î–∞–≤–∞–π—Ç–µ –ø—Ä–æ—Å–ª–µ–¥–∏–º, –∫–∞–∫ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—Ç—Ä–æ–∫–∞ –∑–∞–∫–∞–∑–∞.

### **STG (Staging / Bronze)** ‚Äî ¬´–∫–∞–∫ –ø—Ä–∏—à–ª–æ¬ª

- –¢–∞–±–ª–∏—Ü—ã: `stg.orders_raw`, `stg.customers_raw`;  
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ ‚Äî *—Ç–æ—á–Ω–æ –∫–∞–∫ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ* (–º–æ–∂–µ—Ç –±—ã—Ç—å `VARCHAR` –¥–∞–∂–µ —É –¥–∞—Ç);  
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è:  
  - `_load_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏;  
  - `_load_ts` ‚Äî –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö;  
- –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: **–Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å**. –ï—Å–ª–∏ –ø—Ä–∏—à–ª–∞ –Ω–æ–≤–∞—è –ø–æ—Ä—Ü–∏—è ‚Äî –ª–∏–±–æ –¥–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏, –ª–∏–±–æ *–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º* —Å–ª–æ–π (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å).  
- –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è: –µ—Å–ª–∏ –¥–≤–∞ —Ä–∞–∑–∞ –ø—Ä–∏—à—ë–ª –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∑–∞–∫–∞–∑ ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º –æ–¥–∏–Ω (–ø–æ `order_id + _load_ts`).

> üí° *–ü—Ä–∏–º–µ—Ä:* `stg.orders_raw` —Å–æ–¥–µ—Ä–∂–∏—Ç `"2024-01-10"` –∫–∞–∫ —Å—Ç—Ä–æ–∫—É ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –Ω–µ –ø–æ—Ç–µ—Ä—è—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª.

---

### **ODS (Operational Data Store / Silver)** ‚Äî ¬´–ø–æ—á–∏—Å—Ç–∏–ª–∏, –Ω–æ –Ω–µ —Ç—Ä–æ–≥–∞–ª–∏ —Å–º—ã—Å–ª¬ª

- –¢–∞–±–ª–∏—Ü—ã: `ods.orders`, `ods.customers`;  
- –ó–¥–µ—Å—å:  
  - –ø—Ä–∏–≤–µ–ª–∏ `order_date` –∫ —Ç–∏–ø—É `DATE`;  
  - —É–±—Ä–∞–ª–∏ –∑–∞–∫–∞–∑—ã –±–µ–∑ –∫–ª–∏–µ–Ω—Ç–∞ (`customer_id IS NULL` ‚Üí –æ—à–∏–±–∫–∞ –∏–ª–∏ —Ñ–ª–∞–≥);  
  - –ø—Ä–∏–≤–µ–ª–∏ —Ç–µ–ª–µ—Ñ–æ–Ω—ã –∫ —Ñ–æ—Ä–º–∞—Ç—É `79991112233`;  
  - –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ email –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å (—Ä–µ–≥—É–ª—è—Ä–∫–æ–π –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π).  
- **–ù–æ!** –ù–µ –æ–±—ä–µ–¥–∏–Ω—è–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ CRM –∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ –∑–∞–∫–∞–∑–æ–≤ ‚Äî —ç—Ç–æ –±—É–¥–µ—Ç –ø–æ–∑–∂–µ.  
- –ü–æ–∫–∞ ‚Äî –Ω–∏–∫–∞–∫–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏. –¢–æ–ª—å–∫–æ *—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è* –æ—á–∏—Å—Ç–∫–∞.

> üéØ –¶–µ–ª—å ODS ‚Äî –¥–∞—Ç—å ¬´–Ω–∞–¥—ë–∂–Ω—É—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É¬ª –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ—è. –ö–∞–∫ —Å—É—Ö–æ–µ, —á–∏—Å—Ç–æ–µ –±—Ä–µ–≤–Ω–æ –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π –¥–æ–º–∞.

---

### **DDS (Data Delivery Store / Core / Gold)** ‚Äî ¬´–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è + –∏—Å—Ç–æ—Ä–∏—è¬ª

–ó–¥–µ—Å—å —Ä–æ–∂–¥–∞–µ—Ç—Å—è *–µ–¥–∏–Ω–∞—è –±–∏–∑–Ω–µ—Å-–º–æ–¥–µ–ª—å*.  
–ü–æ—è–≤–ª—è—é—Ç—Å—è –ø–æ–Ω—è—Ç–∏—è: **–∏–∑–º–µ—Ä–µ–Ω–∏—è**, **—Ñ–∞–∫—Ç—ã**, **—Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏**, **SCD**.

–ù–∞–ø—Ä–∏–º–µ—Ä:

| –¢–∞–±–ª–∏—Ü–∞ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|---------|------------|
| `dds.dim_customer` | –ò–∑–º–µ—Ä–µ–Ω–∏–µ ¬´–ö–ª–∏–µ–Ω—Ç¬ª —Å –∏—Å—Ç–æ—Ä–∏–µ–π (SCD Type 2) |
| `dds.dim_product` | –ò–∑–º–µ—Ä–µ–Ω–∏–µ ¬´–¢–æ–≤–∞—Ä¬ª |
| `dds.dim_date` | –ì–æ—Ç–æ–≤—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –Ω–∞ 10 –ª–µ—Ç –≤–ø–µ—Ä—ë–¥ (–¥–µ–Ω—å/–Ω–µ–¥–µ–ª—è/–º–µ—Å—è—Ü/–∫–≤–∞—Ä—Ç–∞–ª) |
| `dds.fact_sales` | –§–∞–∫—Ç ¬´–ü—Ä–æ–¥–∞–∂–∞¬ª ‚Äî —Å—Ç—Ä–æ–∫–∞ –∑–∞–∫–∞–∑–∞ —Å —Å—É–º–º–æ–π –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º |

üí° **–°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á (Surrogate Key, SK)** ‚Äî —ç—Ç–æ `BIGINT`, –∫–æ—Ç–æ—Ä—ã–π –º—ã –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `customer_sk = 1001`).  
**–ë–∏–∑–Ω–µ—Å-–∫–ª—é—á (Business Key, BK)** ‚Äî —ç—Ç–æ `customer_id = 101` –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.  
–ú—ã —Ö—Ä–∞–Ω–∏–º –∏ —Ç–æ, –∏ –¥—Ä—É–≥–æ–µ ‚Äî —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –∏ –¥–∂–æ–π–Ω–∏—Ç—å, –∏ –ø–æ–Ω–∏–º–∞—Ç—å, –æ—Ç–∫—É–¥–∞ —Å—Ç—Ä–æ–∫–∞.

> ‚úÖ –ü–æ—á–µ–º—É –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `customer_id` –Ω–∞–ø—Ä—è–º—É—é?  
> ‚Äî –ü–æ—Ç–æ–º—É —á—Ç–æ –≤ –æ–¥–Ω–æ–º –∏—Å—Ç–æ—á–Ω–∏–∫–µ `customer_id` ‚Äî —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ, –≤ –¥—Ä—É–≥–æ–º ‚Äî —Å—Ç—Ä–æ–∫–∞ `CUST-101`.  
> ‚Äî –ü–æ—Ç–æ–º—É —á—Ç–æ ID –º–æ–≥—É—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –∏ –ø—Ä–æ–¥–æ–≤–æ–π –±–∞–∑–∞—Ö).  
> ‚Äî –ü–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–∞ *—Å–≤—è–∑—å* —Å –∏—Å—Ç–æ—Ä–∏–µ–π: —É –∫–ª–∏–µ–Ω—Ç–∞ —Å BK = `101` –º–æ–∂–µ—Ç –±—ã—Ç—å 3 –≤–µ—Ä—Å–∏–∏ –≤ `dim_customer`.

---

### **DM (Data Mart / ¬´–í–∏—Ç—Ä–∏–Ω—ã¬ª)** ‚Äî ¬´–≥–æ—Ç–æ–≤–æ –∫ —É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏—é¬ª

–ó–¥–µ—Å—å ‚Äî —Ç–∞–±–ª–∏—Ü—ã –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–¥–∞—á:  
- `dm.mart_daily_sales` ‚Äî –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ –ø–æ —Ç–æ–≤–∞—Ä–∞–º –∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º;  
- `dm.mart_customer_360` ‚Äî –ø–æ–ª–Ω—ã–π –ø–æ—Ä—Ç—Ä–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞: —Å–∫–æ–ª—å–∫–æ –ø–æ—Ç—Ä–∞—Ç–∏–ª, –∫–æ–≥–¥–∞ –∑–∞—Ö–æ–¥–∏–ª, –∫–∞–∫–∏–µ —Ç–æ–≤–∞—Ä—ã –ª—é–±–∏—Ç.

–û–Ω–∏ —á–∞—Å—Ç–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –ø–æ –º–æ–¥–µ–ª–∏ **–ó–≤–µ–∑–¥–∞ (Star Schema)** ‚Äî –ø–æ—Ç–æ–º—É —á—Ç–æ BI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º —Ç–∞–∫ —É–¥–æ–±–Ω–µ–µ –≤—Å–µ–≥–æ.

---

## **5. –ë–∞–∑–æ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è: —Ñ–∞–∫—Ç—ã, –∏–∑–º–µ—Ä–µ–Ω–∏—è, SCD**

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –æ—Ç—á—ë—Ç:  
> *¬´10 —è–Ω–≤–∞—Ä—è 2024 –≥–æ–¥–∞ –∫–ª–∏–µ–Ω—Ç –∏–∑ –ú–æ—Å–∫–≤—ã (—Å–µ–≥–º–µ–Ω—Ç Premium) –∫—É–ø–∏–ª Phone –∑–∞ 100 ‚ÇΩ¬ª*.

–í DWH —ç—Ç–æ —Ä–∞–∑–ª–æ–∂–∏—Ç—Å—è –Ω–∞:  
- **–§–∞–∫—Ç (Fact)** ‚Äî —Å–æ–±—ã—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–Ω–æ –∏–∑–º–µ—Ä–∏—Ç—å: *–ø–æ–∫—É–ø–∫–∞*.  
  –•—Ä–∞–Ω–∏—Ç—Å—è –≤ `fact_sales`: `quantity = 1`, `amount = 100`.  
- **–ò–∑–º–µ—Ä–µ–Ω–∏—è (Dimensions)** ‚Äî *–∫–æ–Ω—Ç–µ–∫—Å—Ç* —Ñ–∞–∫—Ç–∞:  
  - `dim_date` ‚Üí 10 —è–Ω–≤–∞—Ä—è 2024;  
  - `dim_customer` ‚Üí –ú–æ—Å–∫–≤–∞, Premium;  
  - `dim_product` ‚Üí Phone.

```mermaid
erDiagram
    dim_date ||--o{ fact_sales : "–¥–∞—Ç–∞"
    dim_customer ||--o{ fact_sales : "–∫–ª–∏–µ–Ω—Ç" 
    dim_product ||--o{ fact_sales : "—Ç–æ–≤–∞—Ä"
    
    dim_customer {
        bigint customer_sk PK "—Å—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á"
        varchar customer_bk "–±–∏–∑–Ω–µ—Å-–∫–ª—é—á, –Ω–∞–ø—Ä. '101'"
        varchar customer_name
        varchar email
        varchar city
        date valid_from
        date valid_to
        boolean is_current
    }
    
    fact_sales {
        bigint sale_id PK
        bigint customer_sk FK
        bigint product_sk FK
        int date_key FK "—Å—Å—ã–ª–∫–∞ –Ω–∞ dim_date.date_key"
        int quantity
        decimal amount
    }
```

### **SCD Type 2 ‚Äî –∫–∞–∫ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é**

–ö–ª–∏–µ–Ω—Ç ‚Ññ101:  
- —Å 1 —è–Ω–≤ –ø–æ 15 –º–∞—è ‚Äî `email = a@ex.com`, `city = –ú–æ—Å–∫–≤–∞`;  
- —Å 16 –º–∞—è ‚Äî `email = b@ex.com`, `city = –ú–æ—Å–∫–≤–∞`;  
- —Å 1 –æ–∫—Ç ‚Äî `email = b@ex.com`, `city = –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥`.

–í `dim_customer` —ç—Ç–æ –±—É–¥–µ—Ç **—Ç—Ä–∏ —Å—Ç—Ä–æ–∫–∏**:

| customer_sk | customer_bk | email | city | valid_from | valid_to | is_current |
|-------------|-------------|-------|------|------------|----------|------------|
| 1001 | 101 | a@ex.com | –ú–æ—Å–∫–≤–∞ | 2023-01-01 | 2023-05-15 | false |
| 1002 | 101 | b@ex.com | –ú–æ—Å–∫–≤–∞ | 2023-05-16 | 2023-09-30 | false |
| 1003 | 101 | b@ex.com | –°–ü–± | 2023-10-01 | 9999-12-31 | true |

–ö–æ–≥–¥–∞ –º—ã —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–¥–∞–∂–∏ –∑–∞ **12 —è–Ω–≤–∞—Ä—è** ‚Äî –¥–∂–æ–π–Ω–∏–º `fact_sales` –∫ —Ç–æ–π —Å—Ç—Ä–æ–∫–µ `dim_customer`, –≥–¥–µ:  
```sql
fact_sales.order_date BETWEEN dim_customer.valid_from AND dim_customer.valid_to
```
–∏ –ø–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –Ω–∞ —Ç–æ—Ç –¥–µ–Ω—å email –∏ –≥–æ—Ä–æ–¥.

> üîç –ü–æ–¥—Ä–æ–±–Ω–µ–µ –ø—Ä–æ SCD ‚Äî –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ [Slow Changing Dimensions](SCD.md) (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ Type 1/2/3, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è).

---

## **6. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–ª–æ—è DDS: 4 –ø–æ–¥—Ö–æ–¥–∞ ‚Äî –∏ –∫–æ–≥–¥–∞ –∫–∞–∫–æ–π –≤—ã–±—Ä–∞—Ç—å**

–í DDS –º—ã –º–æ–∂–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ-—Ä–∞–∑–Ω–æ–º—É. –≠—Ç–æ –Ω–µ ¬´–ø—Ä–∞–≤–∏–ª—å–Ω–æ/–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ¬ª, –∞ **–≤—ã–±–æ—Ä –ø–æ–¥ –∑–∞–¥–∞—á—É**.

### **1. 3NF (—Ç—Ä–µ—Ç—å—è –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞)**  
*–ò—Å—Ç–æ—á–Ω–∏–∫: –ë–∏–ª–ª –ò–Ω–º–æ–Ω (Bill Inmon)*

‚úÖ **–ü–ª—é—Å—ã**:  
- –ú–∏–Ω–∏–º—É–º –∏–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Å—Ç—Ä–æ–≥–∏—Ö –∫–ª—é—á–∞—Ö –∏ –ø—Ä–∞–≤–∏–ª–∞—Ö –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏.
- –ü—Ä–æ—â–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –µ–¥–∏–Ω—É—é —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—é –∏ –ù–°–ò (reference data).
- –ê—Ç—Ä–∏–±—É—Ç—ã –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏ –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å.

‚ùå **–ú–∏–Ω—É—Å—ã**:  
- –ú–Ω–æ–≥–æ JOIN –¥–∞–∂–µ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –æ—Ç—á—ë—Ç–æ–≤.
- –ò—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç—å (SCD2) —É—Å–ª–æ–∂–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã.
- –ù–æ–≤—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ—Ä–æ–∂–µ –≥–∞—Ä–º–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å (–ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∫–∞–Ω–æ–Ω—É).

üìå **–ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å**:  
‚Üí –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ DWH, –≥–¥–µ –≤–∞–∂–Ω–∞ *–µ–¥–∏–Ω–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è* –∏ *–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞*.  
‚Üí –°—Ç–∞–±–∏–ª—å–Ω—ã–µ –¥–æ–º–µ–Ω—ã (—Ñ–∏–Ω–∞–Ω—Å—ã, –ù–°–ò, –¥–æ–≥–æ–≤–æ—Ä—ã) –∏ —É–º–µ—Ä–µ–Ω–Ω–∞—è –¥–∏–Ω–∞–º–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

---

### **2. –ó–≤–µ–∑–¥–∞ (Star Schema)**  
*–ò—Å—Ç–æ—á–Ω–∏–∫: –†–∞–ª—å—Ñ –ö–∏–º–±–æ–ª–ª (Ralph Kimball)*

‚úÖ **–ü–ª—é—Å—ã**:  
- **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: —Ñ–∞–∫—Ç + –Ω–µ—Å–∫–æ–ª—å–∫–æ ¬´–ø–ª–æ—Å–∫–∏—Ö¬ª –∏–∑–º–µ—Ä–µ–Ω–∏–π;  
- **–°–∫–æ—Ä–æ—Å—Ç—å**: BI-—Å–∏—Å—Ç–µ–º—ã –ª—é–±—è—Ç –∑–≤–µ–∑–¥—É ‚Äî –∑–∞–ø—Ä–æ—Å—ã –ø–∏—à—É—Ç—Å—è –∑–∞ 5 –º–∏–Ω—É—Ç;  
- **–ü–æ–Ω—è—Ç–Ω–æ –±–∏–∑–Ω–µ—Å—É**: ¬´–ø—Ä–æ–¥–∞–∂–∏ –ø–æ —Ç–æ–≤–∞—Ä–∞–º –∏ –∫–ª–∏–µ–Ω—Ç–∞–º¬ª ‚Äî —ç—Ç–æ —Ä–æ–≤–Ω–æ —Ç–æ, —á—Ç–æ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö.

‚ùå **–ú–∏–Ω—É—Å—ã**:  
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ: –≥–æ—Ä–æ–¥ –±—É–¥–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ –∫–ª–∏–µ–Ω—Ç–∞;  
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è ‚Äî –¥–æ—Ä–æ–≥–æ (–ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å –≤—Å—é –≤–∏—Ç—Ä–∏–Ω—É).

üìå **–ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å**:  
‚Üí –í–∏—Ç—Ä–∏–Ω—ã (DM), –∞ –Ω–µ —è–¥—Ä–æ (DDS);  
‚Üí –ù–∞—á–∏–Ω–∞—é—â–∏–º –∫–æ–º–∞–Ω–¥–∞–º –∏ MVP;  
‚Üí –ö–æ–≥–¥–∞ –æ—Ç—á—ë—Ç—ã ‚Äî –≥–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å.

---

### **3. Data Vault 2.0 ‚Äî ¬´–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä Lego¬ª –¥–ª—è –±–æ–ª—å—à–∏—Ö DWH**

*–ò–¥–µ—è: –î—ç–Ω –õ–∏–Ω—Å—Ç–µ–¥—Ç (Dan Linstedt). –¶–µ–ª—å ‚Äî —Å–æ–±–∏—Ä–∞—Ç—å DWH –∏–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –±–ª–æ–∫–æ–≤, –Ω–µ –±–æ—è—Å—å, —á—Ç–æ –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ ¬´—Å–ª–æ–º–∞–µ—Ç¬ª –≤—Å—ë, —á—Ç–æ –±—ã–ª–æ –¥–æ –Ω–µ–≥–æ.*

#### –° —á–µ–≥–æ –Ω–∞—á–∞—Ç—å? –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä

–£ –≤–∞—Å –µ—Å—Ç—å –∫–æ—Ä–æ–±–∫–∞ Lego. –í –Ω–µ–π:
- **–ö—Ä–∞—Å–Ω—ã–µ –∫–∏—Ä–ø–∏—á–∏ (–•–∞–±—ã)** ‚Äî —ç—Ç–æ *¬´—á—Ç–æ –∏–ª–∏ –∫—Ç–æ¬ª*: –∫–ª–∏–µ–Ω—Ç, –∑–∞–∫–∞–∑, —Ç–æ–≤–∞—Ä.  
  –£ –Ω–∏—Ö –Ω–µ—Ç —Ü–≤–µ—Ç–∞, –Ω–∞–¥–ø–∏—Å–µ–π ‚Äî —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∞ (–±–∏–∑–Ω–µ—Å-–∫–ª—é—á). –ì–ª–∞–≤–Ω–æ–µ ‚Äî *—É–∑–Ω–∞—Ç—å*, —á—Ç–æ —ç—Ç–æ ¬´–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª–∏–µ–Ω—Ç ‚Ññ101¬ª, –¥–∞–∂–µ –µ—Å–ª–∏ –µ–≥–æ email –º–µ–Ω—è–ª—Å—è —Ç—Ä–∏–∂–¥—ã.
- **–°–µ—Ä—ã–µ —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª–∏ (–õ–∏–Ω–∫–∏)** ‚Äî —ç—Ç–æ *¬´–∫–∞–∫ —Å–≤—è–∑–∞–Ω—ã¬ª*: ¬´–∑–∞–∫–∞–∑ ‚Ññ5001 —Å–æ–∑–¥–∞–Ω –∫–ª–∏–µ–Ω—Ç–æ–º ‚Ññ101¬ª.  
  –ù–µ —Å–∞–º–∏ –æ–±—ä–µ–∫—Ç—ã, –∞ *—Å–≤—è–∑—å –º–µ–∂–¥—É –Ω–∏–º–∏*. –ò –¥–∞–∂–µ —ç—Ç—É —Å–≤—è–∑—å –º–æ–∂–Ω–æ ¬´–æ—Ç–≤—è–∑–∞—Ç—å¬ª –∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É ‚Äî –±–µ–∑ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏ –∫–∏—Ä–ø–∏—á–µ–π.
- **–ñ—ë–ª—Ç—ã–µ –Ω–∞–∫–ª–µ–π–∫–∏ (–°–∞—Ç–µ–ª–ª–∏—Ç—ã)** ‚Äî —ç—Ç–æ *¬´–∫–∞–∫–∏–µ —É –Ω–∏—Ö —Å–≤–æ–π—Å—Ç–≤–∞¬ª*: –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞, —Å—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞, —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞.  
  –ò —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ: **–∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —á—Ç–æ-—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å ‚Äî –Ω–∞–∫–ª–µ–∏–≤–∞–µ–º –Ω–æ–≤—É—é –∂—ë–ª—Ç—É—é –Ω–∞–∫–ª–µ–π–∫—É**, –Ω–µ —Å—Ç–∏—Ä–∞—è —Å—Ç–∞—Ä—É—é. –¢–∞–∫ —É –Ω–∞—Å –æ—Å—Ç–∞—ë—Ç—Å—è *–ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è*.

üí° **–ì–ª–∞–≤–Ω—ã–π –ø—Ä–∏–Ω—Ü–∏–ø DV**:  
> *¬´–ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å ‚Äî –Ω–∞–≤—Å–µ–≥–¥–∞. –°–≤–æ–π—Å—Ç–≤–∞ ‚Äî –º–µ–Ω—è—é—Ç—Å—è. –°–≤—è–∑–∏ ‚Äî —Ç–æ–∂–µ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è. –ò –≤—Å—ë —ç—Ç–æ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–æ.¬ª*

```mermaid
erDiagram
    %% –•–∞–±—ã - –∫—Ä–∞—Å–Ω—ã–µ –∫–∏—Ä–ø–∏—á–∏ (–∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å)
    %% –°–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
    HUB_CUSTOMER ||--o{ SAT_CUSTOMER_INFO : "–∏–º–µ–µ—Ç"
    HUB_CUSTOMER ||--o{ LINK_ORDER_CUSTOMER : "—É—á–∞—Å—Ç–≤—É–µ—Ç_–≤"
    HUB_ORDER ||--o{ LINK_ORDER_CUSTOMER : "—Å–æ–∑–¥–∞–Ω"
    LINK_ORDER_CUSTOMER ||--o{ SAT_ORDER_STATUS : "–∏–º–µ–µ—Ç_—Å—Ç–∞—Ç—É—Å"

    HUB_CUSTOMER {
        varchar customer_bk PK "–ë–∏–∑–Ω–µ—Å-–∫–ª—é—á: '101'"
        varchar record_source
        timestamp load_dttm
    }
    
    HUB_ORDER {
        varchar order_id PK "–ë–∏–∑–Ω–µ—Å-–∫–ª—é—á: '5001'"
        varchar record_source
        timestamp load_dttm
    }
    
    %% –õ–∏–Ω–∫–∏ - —Å–µ—Ä—ã–µ —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª–∏ (—Å–≤—è–∑–∏)
    LINK_ORDER_CUSTOMER {
        varchar link_key PK "–•—ç—à –æ—Ç (order_id+customer_bk)"
        varchar order_id FK "‚Üí HUB_ORDER"
        varchar customer_bk FK "‚Üí HUB_CUSTOMER"
        varchar record_source
        timestamp load_dttm
    }
    
    %% –°–∞—Ç–µ–ª–ª–∏—Ç—ã - –∂—ë–ª—Ç—ã–µ –Ω–∞–∫–ª–µ–π–∫–∏ (–∞—Ç—Ä–∏–±—É—Ç—ã + –∏—Å—Ç–æ—Ä–∏—è)
    SAT_CUSTOMER_INFO {
        varchar customer_bk FK "‚Üí HUB_CUSTOMER"
        varchar hashdiff
        timestamp valid_from
        timestamp valid_to
        varchar name
        varchar email
        varchar city
        varchar record_source
        timestamp load_dttm
    }
    
    SAT_ORDER_STATUS {
        varchar link_key FK "‚Üí LINK_ORDER_CUSTOMER"
        varchar hashdiff
        timestamp valid_from
        timestamp valid_to
        varchar status
        varchar record_source
        timestamp load_dttm
    }
    
```

> **–ö–∞–∫ —á–∏—Ç–∞—Ç—å —Å—Ö–µ–º—É:**  
> üî¥ **–ö—Ä–∞—Å–Ω—ã–µ –±–ª–æ–∫–∏ (–•–∞–±—ã)** = ¬´–ö—Ç–æ/—á—Ç–æ —ç—Ç–æ?¬ª ‚Äî —Ç–æ–ª—å–∫–æ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å, –Ω–∏–∫–∞–∫–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤.  
> ‚ö™ **–°–µ—Ä—ã–µ –±–ª–æ–∫–∏ (–õ–∏–Ω–∫–∏)** = ¬´–ö–∞–∫ —Å–≤—è–∑–∞–Ω—ã?¬ª ‚Äî —Å–æ–µ–¥–∏–Ω—è—é—Ç —Ö–∞–±—ã, —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è.  
> üü° **–ñ—ë–ª—Ç—ã–µ –±–ª–æ–∫–∏ (–°–∞—Ç–µ–ª–ª–∏—Ç—ã)** = ¬´–ö–∞–∫–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞?¬ª ‚Äî —Ö—Ä–∞–Ω—è—Ç –∞—Ç—Ä–∏–±—É—Ç—ã + –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π.  
>   
> üí° **–ü—Ä–∞–≤–∏–ª–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞:** –ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ), –º—ã –ø—Ä–æ—Å—Ç–æ ¬´–ø—Ä–∏–∫–ª–µ–∏–≤–∞–µ–º¬ª –Ω–æ–≤—ã–π —Å–∞—Ç–µ–ª–ª–∏—Ç –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Ö–∞–±—É ‚Äî –Ω–µ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞—è –≤—Å—é –º–æ–¥–µ–ª—å.

---

#### –ü–æ—á–µ–º—É —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ SCD Type 2 ¬´–ø–æ-–¥—Ä—É–≥–æ–º—É¬ª?

–í SCD Type 2 (–≤ `dim_customer`) –º—ã *—Å–º–µ—à–∏–≤–∞–µ–º*:
- –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å (`customer_bk = 101`),  
- –∏ –∞—Ç—Ä–∏–±—É—Ç—ã (`email`, `city`),  
- –∏ —Å–≤—è–∑—å —Å –±–∏–∑–Ω–µ—Å-—Å–æ–±—ã—Ç–∏—è–º–∏ (`valid_from`, `is_current`).

–í Data Vault —ç—Ç–∏ —Ç—Ä–∏ –≤–µ—â–∏ **—Ä–∞–∑–Ω–µ—Å–µ–Ω—ã –ø–æ —Ä–∞–∑–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º**:
- `hub_customer` ‚Äî —Ç–æ–ª—å–∫–æ `customer_bk` –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è (–æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à—ë–ª, –∫–æ–≥–¥–∞ –∑–∞–≥—Ä—É–∑–∏–ª–∏);  
- `sat_customer_info` ‚Äî —Ç–æ–ª—å–∫–æ –∞—Ç—Ä–∏–±—É—Ç—ã + –∏—Ö –∏—Å—Ç–æ—Ä–∏—è (–∫–∞–∫ –≤ SCD, –Ω–æ –æ—Ç–¥–µ–ª—å–Ω–æ!);  
- `link_order_customer` ‚Äî —Ç–æ–ª—å–∫–æ ¬´–∫—Ç–æ —Å–¥–µ–ª–∞–ª –∑–∞–∫–∞–∑¬ª (–∏ –¥–∞–∂–µ —Ç—É—Ç ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∞—Ç–µ–ª–ª–∏—Ç –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å *—Å—Ç–∞—Ç—É—Å —Å–≤—è–∑–∏*: ¬´–∞–∫—Ç–∏–≤–Ω—ã–π¬ª, ¬´–æ—Ç–º–µ–Ω—ë–Ω–Ω—ã–π¬ª –∏ —Ç.–¥.).

‚û°Ô∏è –≠—Ç–æ –¥–∞—ë—Ç **–æ–≥—Ä–æ–º–Ω—ã–π –±–æ–Ω—É—Å**:  
–ï—Å–ª–∏ –∑–∞–≤—Ç—Ä–∞ –ø—Ä–∏—à—ë–ª –Ω–æ–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî –∏ —Ç–∞–º —É –∫–ª–∏–µ–Ω—Ç–∞ –µ—Å—Ç—å `device_id`,  
–≤—ã **–Ω–µ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ `dim_customer`** (–∫–∞–∫ –≤ Kimball/3NF),  
–∞ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ—Ç–µ **–Ω–æ–≤—ã–π —Å–∞—Ç–µ–ª–ª–∏—Ç** ‚Äî `sat_customer_device`.  
–°—Ç–∞—Ä—ã–µ –æ—Ç—á—ë—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å. –ù–æ–≤—ã–µ ‚Äî –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—É—é –Ω–∞–∫–ª–µ–π–∫—É.

---

#### –ö–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω ¬´—Å—ã—Ä–æ–π¬ª Data Vault (—É–ø—Ä–æ—â—ë–Ω–Ω–æ)

| –¢–∞–±–ª–∏—Ü–∞ | –í–Ω—É—Ç—Ä–∏ | –ü—Ä–∏–º–µ—Ä |
|---------|--------|--------|
| **`hub_customer`** | `customer_bk` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `'101'`) + `load_dttm` + `source` | –ö–ª–∏–µ–Ω—Ç ¬´101¬ª –ø–æ—è–≤–∏–ª—Å—è –≤ CRM 10 —è–Ω–≤–∞—Ä—è |
| **`sat_customer_info`** | `customer_bk`, `email`, `city`, `valid_from`, `valid_to`, `load_dttm` | 10 —è–Ω–≤‚Äì15 –º–∞—è: `a@ex.com`, –ú–æ—Å–∫–≤–∞; 16 –º–∞—è‚Äì‚Ä¶: `b@ex.com`, –ú–æ—Å–∫–≤–∞ |
| **`hub_order`** | `order_id` + `load_dttm` + `source` | –ó–∞–∫–∞–∑ ¬´5001¬ª –∏–∑ —Å–∏—Å—Ç–µ–º—ã –∑–∞–∫–∞–∑–æ–≤ |
| **`link_order_customer`** | `order_id`, `customer_bk` + `load_dttm` + `source` | –ó–∞–∫–∞–∑ 5001 ‚Üí –∫–ª–∏–µ–Ω—Ç 101 |
| **`sat_order_status`** *(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)* | `order_id`, `status`, `valid_from`, `valid_to` | 10 —è–Ω–≤: ¬´–æ–ø–ª–∞—á–µ–Ω¬ª, 12 —è–Ω–≤: ¬´–¥–æ—Å—Ç–∞–≤–ª–µ–Ω¬ª |

> ‚ö†Ô∏è *–ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –≤–º–µ—Å—Ç–æ `customer_bk` —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **—Ö—ç—à-–∫–ª—é—á** (`hk_customer`) ‚Äî —á—Ç–æ–±—ã —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –±—ã—Å—Ç—Ä–µ–µ –∏ –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å —Ç–∏–ø–∞–º–∏ (—á–∏—Å–ª–æ vs —Å—Ç—Ä–æ–∫–∞).

---

#### –ê –∫–∞–∫ –∂–µ –æ—Ç—á—ë—Ç—ã? –ì–¥–µ –≤–∏—Ç—Ä–∏–Ω—ã?

–•–æ—Ä–æ—à–∏–π –≤–æ–ø—Ä–æ—Å. **–°—ã—Ä–æ–π DV ‚Äî –Ω–µ –¥–ª—è BI.** –≠—Ç–æ ¬´—Å–∫–ª–∞–¥ –∑–∞–ø—á–∞—Å—Ç–µ–π¬ª.  
–ß—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å ¬´–º–∞—à–∏–Ω—É¬ª, –Ω—É–∂–µ–Ω –≤—Ç–æ—Ä–æ–π —à–∞–≥: **Business Vault** (–≤ DV 2.0 —ç—Ç–æ ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —á–∞—Å—Ç—å!).

–¢–∞–º —É–∂–µ:
- **PIT-—Ç–∞–±–ª–∏—Ü—ã (Point-in-Time)** ‚Äî ¬´–∫–∞–∫–æ–π –∫–ª–∏–µ–Ω—Ç –±—ã–ª 12 —è–Ω–≤–∞—Ä—è 2024?¬ª –∑–∞ 1 JOIN, –∞ –Ω–µ –∑–∞ 5 –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π;  
- **Bridge-—Ç–∞–±–ª–∏—Ü—ã** ‚Äî –≥–æ—Ç–æ–≤—ã–µ –ø—É—Ç–∏: ¬´–∑–∞–∫–∞–∑ ‚Üí –∫–ª–∏–µ–Ω—Ç ‚Üí –ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è –ø—Ä–æ—Ñ–∏–ª—è¬ª;  
- **Derived-—Ç–∞–±–ª–∏—Ü—ã** ‚Äî –ø–æ—Å–ª–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (—Å–∫–∏–¥–∫–∏, —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è, —Ñ–ª–∞–≥–∏).

–ê *—É–∂–µ –∏–∑ –Ω–∏—Ö* —Å—Ç—Ä–æ—è—Ç **–≤–∏—Ç—Ä–∏–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ó–≤–µ–∑–¥—ã** ‚Äî —Ç–µ —Å–∞–º—ã–µ `mart_daily_sales`, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –ø–æ–¥–∫–ª—é—á–∞–µ—Ç–µ –≤ Power BI.

üîÅ –¢–æ –µ—Å—Ç—å —Ü–µ–ø–æ—á–∫–∞:  
**–ò—Å—Ç–æ—á–Ω–∏–∫ ‚Üí Hub/Link/Sat (Raw DV) ‚Üí PIT/Bridge (Business Vault) ‚Üí Star Schema (DM)**
–ú–æ–∂–Ω–æ —Å—Ç—Ä–æ–∏—Ç—å –∏ –Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ PIT/Bridge —Ç–∞–±–ª–∏—Ü. –ù–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ "—Ç—è–∂–µ–ª–µ–µ" —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –∑–∞—Ç—Ä–∞—Ç –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.

---

#### –ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã ‚Äî —á–µ—Å—Ç–Ω–æ –∏ –±–µ–∑ –ø—Ä–∏–∫—Ä–∞—Å

| ‚úÖ –ü–ª—é—Å—ã | ‚ùå –ú–∏–Ω—É—Å—ã |
|---------|----------|
| **–ò—Å—Ç–æ—Ä–∏—è ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª** ‚Äî –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–∏–¥–Ω–æ, –Ω–∏—á–µ–≥–æ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è | –°—ã—Ä–æ–π —Å–ª–æ–π —Ç—è–∂–µ–ª –¥–ª—è —á—Ç–µ–Ω–∏—è ‚Äî –Ω—É–∂–µ–Ω Business Vault (–¥–æ–ø. —Ä–∞–±–æ—Ç–∞) |
| **–î–æ–±–∞–≤–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ ‚Äî –ª–µ–≥–∫–æ** (–Ω–æ–≤—ã–π —Å–∞—Ç–µ–ª–ª–∏—Ç, –Ω–µ –ª–æ–º–∞—è —Å—Ç–∞—Ä–æ–µ) | **–ù–æ–≤—ã—Ö —Ç–∞–±–ª–∏—Ü –º–Ω–æ–≥–æ** (Hub/Link/Sat ‚Äî —É–∂–µ 3 –Ω–∞ –ø—Ä–æ—Å—Ç—É—é —Å—É—â–Ω–æ—Å—Ç—å) |
| **–ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞**: –∫—Ç–æ, –æ—Ç–∫—É–¥–∞, –∫–æ–≥–¥–∞ –ø—Ä–∏–≤—ë–∑ –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ—á–∫—É | **–¢—Ä–µ–±—É–µ—Ç –¥–∏—Å—Ü–∏–ø–ª–∏–Ω—ã**: –µ—Å–ª–∏ `record_source` –∑–∞–±—ã–ª–∏ ‚Äî –∞—É–¥–∏—Ç —Å–ª–æ–º–∞–Ω |
| **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞**: –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ ‚Äî –∫–ª–∏–µ–Ω—Ç—ã, –¥—Ä—É–≥–∞—è ‚Äî –∑–∞–∫–∞–∑—ã | **–ù–µ –¥–ª—è MVP**: –æ–∫—É–ø–∞–µ—Ç—Å—è –Ω–∞ 10+ –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö, –Ω–µ –Ω–∞ –¥–≤—É—Ö CSV |

---

#### –ö–æ–≥–¥–∞ Data Vault ‚Äî –≤–∞—à –≤—ã–±–æ—Ä?

| –í—ã–±–µ—Ä–∏—Ç–µ DV 2.0, –µ—Å–ª–∏‚Ä¶ | –ù–µ –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å DV, –µ—Å–ª–∏‚Ä¶ |
|------------------------|---------------------------|
| –£ –≤–∞—Å 5+ —Ä–∞–∑–Ω–æ—Ä–æ–¥–Ω—ã—Ö —Å–∏—Å—Ç–µ–º (CRM, ERP, –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤–Ω–µ—à–Ω–∏–µ API) | –£ –≤–∞—Å 1‚Äì2 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –¥–∞—Ç—å –æ—Ç—á—ë—Ç |
| –°—Ö–µ–º—ã —á–∞—Å—Ç–æ –º–µ–Ω—è—é—Ç—Å—è (–Ω–æ–≤—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã, –Ω–æ–≤—ã–µ —Å–≤—è–∑–∏) | –°—Ö–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É—á—ë—Ç –¥–æ–≥–æ–≤–æ—Ä–æ–≤ –≤ –±–∞–Ω–∫–µ) |
| –í–∞–∂–µ–Ω –∞—É–¥–∏—Ç: ¬´–∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª email?¬ª (—Ñ–∏–Ω—Ç–µ—Ö, –≥–æ—Å—Å–µ–∫—Ç–æ—Ä) | –û—Ç—á—ë—Ç—ã ‚Äî –≥–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å, –∞ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–∞–º |
| –í –±—É–¥—É—â–µ–º ‚Äî –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ: –Ω–æ–≤—ã–µ –¥–æ–º–µ–Ω—ã, –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã | –í—ã –æ–¥–∏–Ω –∏–ª–∏ –≤–¥–≤–æ—ë–º, –∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ—Ç—ã |

> üéØ **–°–æ–≤–µ—Ç –¥–ª—è –Ω–æ–≤–∏—á–∫–∞**:  
> –ü–æ–∫–∞ —É—á–∏—Ç–µ—Å—å ‚Äî *–Ω–µ –ø—ã—Ç–∞–π—Ç–µ—Å—å —Å–æ–±—Ä–∞—Ç—å DV –≤—Ä—É—á–Ω—É—é*. –ù–æ **–ø–æ–Ω–∏–º–∞—Ç—å –µ–≥–æ –ª–æ–≥–∏–∫—É ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ**.  
> –ü–æ—á–µ–º—É? –ü–æ—Ç–æ–º—É —á—Ç–æ –º–Ω–æ–≥–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ enterprise-DWH —Å–µ–≥–æ–¥–Ω—è ‚Äî –ª–∏–±–æ DV, –ª–∏–±–æ –≥–∏–±—Ä–∏–¥—ã (DV + Star).  
> –î–∞–∂–µ –µ—Å–ª–∏ –≤—ã –±—É–¥–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–∏—Ç—Ä–∏–Ω–∞–º–∏ ‚Äî –≤—ã –±—É–¥–µ—Ç–µ *–ø–æ–Ω–∏–º–∞—Ç—å*, –æ—Ç–∫—É–¥–∞ –±–µ—Ä—É—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏ –ø–æ—á–µ–º—É –∏—Å—Ç–æ—Ä–∏—è ¬´–Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è¬ª.

---

#### –í–∞–∂–Ω–æ: DV 1.0 vs DV 2.0 ‚Äî –≤ —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞?

- **DV 1.0** ‚Äî —Ç–æ–ª—å–∫–æ Hub/Link/Sat + –∏—Å—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ `load_dttm`.  
  *–ü—Ä–æ–±–ª–µ–º–∞:* –Ω–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Å–ø–æ—Å–æ–±–∞ —Ö—Ä–∞–Ω–∏—Ç—å *–ø–µ—Ä–∏–æ–¥—ã –¥–µ–π—Å—Ç–≤–∏—è* (–∫–∞–∫ –≤ SCD Type 2) ‚Äî `valid_from/valid_to` –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –∏–∑–æ–±—Ä–µ—Ç–∞—Ç—å —Å–∞–º–∏–º.

- **DV 2.0** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ—Ç:  
  - **Effectivity Satellites** (—Å `valid_from/valid_to`) ‚Äî –¥–ª—è —è–≤–Ω–æ–π –∏—Å—Ç–æ—Ä–∏—á–Ω–æ—Å—Ç–∏,  
  - **Multi-Active Satellites** ‚Äî –∫–æ–≥–¥–∞ —É –æ–±—ä–µ–∫—Ç–∞ *–Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π* (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç—Ä–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–µ–ª–µ—Ñ–æ–Ω–∞),  
  - **Business Vault** ‚Äî –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Å–ª–æ–π –ø–µ—Ä–µ–¥ –≤–∏—Ç—Ä–∏–Ω–∞–º–∏.

‚û°Ô∏è –°–µ–≥–æ–¥–Ω—è, –∫–æ–≥–¥–∞ –≥–æ–≤–æ—Ä—è—Ç ¬´Data Vault¬ª, –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –∏–º–µ—é—Ç –≤ –≤–∏–¥—É **DV 2.0**.

---

### **4. Anchor Modeling (–∞–Ω–∫–µ—Ä–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ)**  
*–ò—Å—Ç–æ—á–Ω–∏–∫: –õ–∞—Ä—Å –†—ë–Ω–µ (Lars R√∂nnb√§ck)*

–ï—â—ë –±–æ–ª–µ–µ –∞—Ç–æ–º–∞—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥:  
- **Anchor** ‚Äî —Å—É—â–Ω–æ—Å—Ç—å (–∫–ª–∏–µ–Ω—Ç, —Ç–æ–≤–∞—Ä);  
- **Attribute** ‚Äî –∞—Ç—Ä–∏–±—É—Ç (email, –∏–º—è);  
- **Tie** ‚Äî —Å–≤—è–∑—å (–∫–∞–∫ Link –≤ DV);  
- –í—Å–µ —Ç–∞–±–ª–∏—Ü—ã ‚Äî 2‚Äì3 —Å—Ç–æ–ª–±—Ü–∞.

‚úÖ **–ü–ª—é—Å—ã**:  
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–∏–±–∫–æ—Å—Ç—å**: –ø–æ–º–µ–Ω—è–ª–∏ –º–æ–¥–µ–ª—å ‚Äî –Ω–µ —Ç—Ä–æ–≥–∞–ª–∏ —Å—Ç–∞—Ä—ã–µ —Ç–∞–±–ª–∏—Ü—ã;  
- **–ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è**: –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã ¬´–∑–∞–¥–Ω–∏–º —á–∏—Å–ª–æ–º¬ª.

‚ùå **–ú–∏–Ω—É—Å—ã**:  
- –û—á–µ–Ω—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (JOIN‚Äô–æ–≤ ‚Äî –¥–µ—Å—è—Ç–∫–∏);  
- –ü–æ—á—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ¬´–≤ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ¬ª ‚Äî —á–∞—â–µ –∫–∞–∫ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è.

üìå **–ö–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞—Ç—å**:  
‚Üí –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã;  
‚Üí –ö–æ–≥–¥–∞ —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö *–∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü* —Ä–∞–¥–∏–∫–∞–ª—å–Ω–æ –º–µ–Ω—è–µ—Ç—Å—è.

---

### **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π ‚Äî –Ω–∞–≥–ª—è–¥–Ω–æ**

```mermaid
quadrantChart
    title –ì–¥–µ –∫–∞–∫–∞—è –º–æ–¥–µ–ª—å? (–∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ)
    x-axis "–ù–∏–∑–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å ‚Üí –í—ã—Å–æ–∫–∞—è —Å–ª–æÃÅ–∂–Ω–æ—Å—Ç—å"
    y-axis "–ù–∏–∑–∫–∞—è –≥–∏–±–∫–æ—Å—Ç—å ‚Üí –í—ã—Å–æ–∫–∞—è –≥–∏–±–∫–æ—Å—Ç—å"
    "–ó–≤–µ–∑–¥–∞": [0.2, 0.3]
    "3NF": [0.6, 0.5]
    "Data Vault": [0.8, 0.8]
    "Anchor": [0.95, 0.95]
```

> üéØ **–í—ã–≤–æ–¥**: –Ω–µ—Ç ¬´–ª—É—á—à–µ–π¬ª –º–æ–¥–µ–ª–∏. –ï—Å—Ç—å **–ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç**.  
> ‚Äî –î–ª—è –æ–±—É—á–µ–Ω–∏—è ‚Äî **–ó–≤–µ–∑–¥–∞** (–ø—Ä–æ—Å—Ç–æ, –Ω–∞–≥–ª—è–¥–Ω–æ).  
> ‚Äî –î–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ DWH ‚Äî **3NF + –ó–≤–µ–∑–¥–∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ**.  
> ‚Äî –î–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚Äî **Data Vault**.

---

## **7. –ü—Ä–∞–∫—Ç–∏–∫—É–º: –∫–∞–∫ —Å–æ–±—Ä–∞—Ç—å –ø–µ—Ä–≤—É—é –≤–∏—Ç—Ä–∏–Ω—É**

–ü–æ–∫–∞–∂–µ–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ `mart_daily_sales` ‚Äî —Ç–∞–±–ª–∏—Ü—É, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ BI.

### **–≠—Ç–∞–ø—ã —Å–±–æ—Ä–∫–∏**

1. –ò–∑ STG ‚Üí ODS:
   - `stg.orders_raw` ‚Üí `ods.orders` (–ø—Ä–∏–≤–µ–ª–∏ `order_date` –∫ `DATE`);
2. –ò–∑ ODS ‚Üí DDS:
   - `ods.customers` ‚Üí `dds.dim_customer` (SCD Type 2);
   - `ods.products` ‚Üí `dds.dim_product`;
   - `ods.orders` + `ods.order_items` ‚Üí `dds.fact_sales`;
3. –ò–∑ DDS ‚Üí DM:
   - `fact_sales` + `dim_*` ‚Üí `mart_daily_sales`.

```mermaid
flowchart LR
    STG[stg.orders_raw] --> ODS[ods.orders]
    ODS --> DDS[dds.fact_sales]
    dds.dim_customer --> DDS
    dds.dim_product --> DDS
    dds.dim_date --> DDS
    DDS --> DM[mart_daily_sales]
    DM --> BI[Power BI]
```

### **–ì–æ—Ç–æ–≤—ã–µ SQL-—Å–∫—Ä–∏–ø—Ç—ã**

–í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ [`sql/`](dwh-modeling/sql/)):

- [`01_ddl_stg-dds.sql`](dwh-modeling/sql/01_ddl_stg-dds.sql) ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º –∏ —Ç–∞–±–ª–∏—Ü (STG, ODS, DDS)
- [`02_dml_stg-dds.sql`](dwh-modeling/sql/02_dml_stg-dds.sql) ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è
- [`03_demo_increment.sql`](dwh-modeling/sql/03_demo_increment.sql) ‚Äî –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ SCD2
- [`04_validation.sql`](dwh-modeling/sql/04_validation.sql) ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –¥–∞–Ω–Ω—ã—Ö
- [`05_ddl_dm.sql`](dwh-modeling/sql/05_ddl_dm.sql) ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω (Data Marts)
- [`06_dml_dm.sql`](dwh-modeling/sql/06_dml_dm.sql) ‚Äî –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –≤–∏—Ç—Ä–∏–Ω –¥–∞–Ω–Ω—ã–º–∏

### **–ü—Ä–∏–º–µ—Ä SQL-–∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –≤–∏—Ç—Ä–∏–Ω—ã**

```sql
-- mart_daily_sales: –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ —Å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π
CREATE MATERIALIZED VIEW dm.mart_daily_sales AS
SELECT
    d.date_actual AS order_date,
    p.product_name,
    c.customer_segment,        -- –Ω–∞–ø—Ä–∏–º–µ—Ä: 'Premium', 'Basic'
    SUM(f.quantity) AS total_qty,
    SUM(f.amount) AS total_revenue
FROM dds.fact_sales f
JOIN dds.dim_date d
  ON f.date_key = d.date_key
JOIN dds.dim_product p
  ON f.product_sk = p.product_sk
JOIN dds.dim_customer c
  ON f.customer_sk = c.customer_sk
  AND f.order_date BETWEEN c.valid_from AND c.valid_to  -- SCD!
WHERE c.is_current = true  -- –∏–ª–∏ –Ω–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å ‚Äî —Ç–æ–≥–¥–∞ –±—É–¥–µ—Ç –∏—Å—Ç–æ—Ä–∏—è
GROUP BY d.date_actual, p.product_name, c.customer_segment;
```

> üí° **–ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ (MATERIALIZED VIEW)** ‚Äî —ç—Ç–æ ¬´–∫—ç—à¬ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–æ—á—å—é).

---

## **8. –ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö? –°–æ–≤–µ—Ç—ã –æ—Ç –ø—Ä–∞–∫—Ç–∏–∫–æ–≤**

–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏ ‚Äî **–Ω–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞, –∞ —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è**.  
–≠—Ç–æ –∫–∞–∫ —Ä–µ—à–∞—Ç—å: —Å—Ç—Ä–æ–∏—Ç—å –¥–æ–º –∏–∑ –∫–∏—Ä–ø–∏—á–∞, –¥–µ—Ä–µ–≤–∞ –∏–ª–∏ SIP-–ø–∞–Ω–µ–ª–µ–π. –£ –∫–∞–∂–¥–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ ‚Äî —Å–≤–æ–∏ –ø–ª—é—Å—ã, –Ω–æ **–≥–ª–∞–≤–Ω–æ–µ ‚Äî –ø–æ–¥—Ö–æ–¥–∏—Ç –ª–∏ –æ–Ω–∞ *–≤–∞–º* —Å–µ–≥–æ–¥–Ω—è**.

### üîπ –ì–ª–∞–≤–Ω–æ–µ, —á—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å –Ω–æ–≤–∏—á–∫—É:

> **–ù–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ¬´—Å–∞–º–æ–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π¬ª –º–æ–¥–µ–ª–∏.**  
> –ï—Å—Ç—å **—Å–∞–º–∞—è –ø–æ–¥—Ö–æ–¥—è—â–∞—è –ø–æ–¥ –≤–∞—à –∫–æ–Ω—Ç–µ–∫—Å—Ç** ‚Äî –∏ –æ–Ω —É –≤—Å–µ—Ö —Ä–∞–∑–Ω—ã–π.

---

### üõë –ß—Ç–æ –¥–µ–ª–∞—Ç—å **–Ω–µ —Å—Ç–æ–∏—Ç** (–µ—Å–ª–∏ –æ–ø—ã—Ç–∞ < 2 –ª–µ—Ç –≤ DWH):

| –ß—Ç–æ –¥–µ–ª–∞—Ç—å –Ω–µ —Å—Ç–æ–∏—Ç | –ü–æ—á–µ–º—É |
|---------------------|--------|
| **–ë—Ä–∞—Ç—å Data Vault ¬´–ø–æ—Ç–æ–º—É —á—Ç–æ –º–æ–¥–Ω–æ¬ª** | DV —Ç—Ä–µ–±—É–µ—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, CDC, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏. –ë–µ–∑ —ç—Ç–æ–≥–æ ‚Äî –ø–æ–ª—É—á–∏—Ç–µ ¬´–∏—Å—Ç–æ—Ä–∏—é¬ª, –≥–¥–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. |
| **–°—Ç—Ä–æ–∏—Ç—å —Å–ª–æ–∂–Ω—É—é 3NF ¬´–∫–∞–∫ –≤ –∫–Ω–∏–∂–∫–∞—Ö¬ª –ø–æ–¥ 10 —Ç–∞–±–ª–∏—Ü** | –ï—Å–ª–∏ —É –≤–∞—Å 2 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ ‚Äî –≤—ã –ø–æ—Ç—Ä–∞—Ç–∏—Ç–µ 2 –Ω–µ–¥–µ–ª–∏ –Ω–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º –¥–µ–ª–∞—Ç—å 5 JOIN‚Äô–æ–≤ —Ä–∞–¥–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ –æ—Ç—á—ë—Ç–∞. |
| **–ü—ã—Ç–∞—Ç—å—Å—è ¬´—Å–¥–µ–ª–∞—Ç—å —Å—Ä–∞–∑—É –≥–∏–±–∫–æ –Ω–∞ 5 –ª–µ—Ç –≤–ø–µ—Ä—ë–¥¬ª** | –ì–∏–±–∫–æ—Å—Ç—å = —Å–ª–æ–∂–Ω–æ—Å—Ç—å. –ê —Å–ª–æ–∂–Ω–æ—Å—Ç—å = –±–∞–≥–∏, –∑–∞–¥–µ—Ä–∂–∫–∏, –≤—ã–≥–æ—Ä–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã. |

---

### ‚úÖ **–ë–∞–∑–æ–≤—ã–µ —Å–æ–≤–µ—Ç—ã ‚Äî —Å —á–µ–≥–æ –Ω–∞—á–∞—Ç—å, –µ—Å–ª–∏ –≤—ã —É—á–∏—Ç–µ—Å—å –∏–ª–∏ –¥–µ–ª–∞–µ—Ç–µ –ø–µ—Ä–≤—ã–π DWH**

1. **–ù–∞—á–Ω–∏—Ç–µ —Å –≤–∏—Ç—Ä–∏–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ –ó–≤–µ–∑–¥—ã (Star Schema).**  
   ‚Äî –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ: –æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ —Ñ–∞–∫—Ç–æ–≤ + –Ω–µ—Å–∫–æ–ª—å–∫–æ ¬´–ø–ª–æ—Å–∫–∏—Ö¬ª —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤.  
   ‚Äî –≠—Ç–æ –±—ã—Å—Ç—Ä–æ: –æ—Ç—á—ë—Ç –≤ BI ‚Äî –∑–∞ 10 –º–∏–Ω—É—Ç.  
   ‚Äî –≠—Ç–æ –ø–æ–Ω—è—Ç–Ω–æ: –¥–∞–∂–µ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–π–º—ë—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É.

2. **–°—Ç—Ä–æ–π—Ç–µ DDS —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ —ç—Ç–æ *–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ*.**  
   ‚Äî –ï—Å–ª–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ ‚â§ 3 –∏ –æ–Ω–∏ —Å—Ç–∞–±–∏–ª—å–Ω—ã ‚Äî –º–æ–∂–Ω–æ `ods ‚Üí dm` –Ω–∞–ø—Ä—è–º—É—é.  
   ‚Äî –ï—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è (¬´email –≤ CRM –∏ –≤ –∑–∞–∫–∞–∑–∞—Ö ‚Äî —Ä–∞–∑–Ω—ã–µ¬ª), *—Ç–æ–≥–¥–∞* –∑–∞–≤–æ–¥–∏—Ç–µ `dds.dim_customer`.

3. **–ò—Å—Ç–æ—Ä–∏—é (SCD) –≤–∫–ª—é—á–∞–π—Ç–µ *–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ*.**  
   ‚Äî –°–Ω–∞—á–∞–ª–∞ ‚Äî –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏ (Type 1: –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç–µ —Å—Ç—Ä–æ–∫—É).  
   ‚Äî –ü–æ—Ç–æ–º ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π (–∫–ª–∏–µ–Ω—Ç, —Ç–æ–≤–∞—Ä).  
   ‚Äî –¢–æ–ª—å–∫–æ –ø–æ—Ç–æ–º ‚Äî –¥—É–º–∞–π—Ç–µ –ø—Ä–æ DV –∏–ª–∏ –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏–∑–∞—Ü–∏—é.

4. **–ï—Å–ª–∏ —Å–æ–º–Ω–µ–≤–∞–µ—Ç–µ—Å—å ‚Äî —Å–ø—Ä–æ—Å–∏—Ç–µ: ¬´–ê –∫—Ç–æ –±—É–¥–µ—Ç —ç—Ç–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è?¬ª**  
   ‚Äî –ê–Ω–∞–ª–∏—Ç–∏–∫ –≤ Metabase ‚Üí –ó–≤–µ–∑–¥–∞.  
   ‚Äî BI-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –≤ Power BI ‚Üí –ó–≤–µ–∑–¥–∞.  
   ‚Äî –ò–Ω–∂–µ–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç—Ä–æ–∏—Ç ML-—Ñ–∏—á–∏ ‚Üí 3NF –∏–ª–∏ –¥–∞–∂–µ —Å—ã—Ä—ã–µ ODS-—Ç–∞–±–ª–∏—Ü—ã.  
   ‚Äî –ê—É–¥–∏—Ç–æ—Ä –∏–ª–∏ —Ä–µ–≥—É–ª—è—Ç–æ—Ä ‚Üí DV (–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—ã *–≥–æ—Ç–æ–≤—ã* –∫ –µ–≥–æ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏).

---

### üí° –ò –µ—â—ë –æ–¥–∏–Ω —Å–æ–≤–µ—Ç –æ—Ç –ø—Ä–∞–∫—Ç–∏–∫–æ–≤:

> **–õ—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å ‚Äî –∏ –≤–æ–≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å,**  
> —á–µ–º —Å–¥–µ–ª–∞—Ç—å ¬´–∏–¥–µ–∞–ª—å–Ω—É—é¬ª ‚Äî –∏ –∑–∞—Å—Ç—Ä—è—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å –ó–≤–µ–∑–¥—É ‚Üí –ó–≤–µ–∑–¥–∞ —Å SCD Type 2 ‚Äî –ª–µ–≥–∫–æ.  
–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å ¬´–Ω–µ–¥–æ–¥–µ–ª–∞–Ω–Ω—ã–π DV¬ª ‚Üí —á—Ç–æ-—Ç–æ —Ä–∞–±–æ—á–µ–µ ‚Äî –≤ 10 —Ä–∞–∑ —Å–ª–æ–∂–Ω–µ–µ.

---

### üìå –ö—Ä–∞—Ç–∫–æ ‚Äî —á—Ç–æ –≤—ã–±—Ä–∞—Ç—å *—Å–µ–≥–æ–¥–Ω—è*, –µ—Å–ª–∏ –≤—ã —Ç–æ–ª—å–∫–æ —É—á–∏—Ç–µ—Å—å:

| –£ –≤–∞—Å‚Ä¶ | –î–µ–ª–∞–π—Ç–µ‚Ä¶ |
|--------|----------|
| –£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, 1‚Äì2 CSV | `ods ‚Üí dm` –ø–æ –º–æ–¥–µ–ª–∏ **–ó–≤–µ–∑–¥–∞** (–±–µ–∑ DDS, –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏) |
| –ü–µ—Ä–≤—ã–π —Ä–∞–±–æ—á–∏–π DWH, 3‚Äì5 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ | `stg ‚Üí ods ‚Üí dds (3NF/–ø—Ä–æ—Å—Ç–∞—è –ó–≤–µ–∑–¥–∞) ‚Üí dm (–ó–≤–µ–∑–¥–∞)` |
| –ö–æ–º–∞–Ω–¥–∞ –∏–∑ 1 –∏–Ω–∂–µ–Ω–µ—Ä–∞ + 1 –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ | **–ù–µ —Ç—Ä–æ–≥–∞–π—Ç–µ DV –∏ Anchor** ‚Äî –æ–Ω–∏ ¬´—Å—ä–µ–¥—è—Ç¬ª –≤–∞—à–µ –≤—Ä–µ–º—è –±–µ–∑ –æ—Ç–¥–∞—á–∏ |

–ê –∫–æ–≥–¥–∞ –Ω–∞–±–µ—Ä—ë—Ç–µ—Å—å –æ–ø—ã—Ç–∞ ‚Äî –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ –≤ DV. –û–Ω —Ç–æ–≥–æ —Å—Ç–æ–∏—Ç. –ù–æ *–Ω–µ —Ä–∞–Ω—å—à–µ –≤—Ä–µ–º–µ–Ω–∏*.

---

## **9. –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è: –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –Ω–µ ¬´–æ–ø—Ü–∏—è¬ª**

–°–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–∞, –µ—Å–ª–∏ –≤ `mart_daily_sales` ‚Äî –Ω—É–ª–∏.  
–ü–æ—ç—Ç–æ–º—É –≤ –∫–∞–∂–¥–æ–º —Å–ª–æ–µ ‚Äî **–∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ (DQ, Data Quality)**.

```mermaid
graph TB
    A[–î–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—É–ø–∏–ª–∏] --> B{–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞}
    
    B --> C["–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å: order_id ‚Äî —É–Ω–∏–∫–∞–ª–µ–Ω?"]
    B --> D["–ü–æ–ª–Ω–æ—Ç–∞: email –Ω–µ NULL?"]
    B --> E["–í–∞–ª–∏–¥–Ω–æ—Å—Ç—å: order_date ‚Äî –¥–∞—Ç–∞?"]
    B --> F["–°–≤–µ–∂–µ—Å—Ç—å: –¥–∞–Ω–Ω—ã–µ –∑–∞ —Å–µ–≥–æ–¥–Ω—è?"]
    
    C --> G{OK?}
    D --> G
    E --> G
    F --> G
    
    G -->|–î–∞| H[–ó–∞–≥—Ä—É–∑–∏—Ç—å –≤ —Å–ª–µ–¥—É—é—â–∏–π —Å–ª–æ–π]
    G -->|–ù–µ—Ç| I[–û–ø–æ–≤–µ—â–µ–Ω–∏–µ + –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞]
```

–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–≤–µ—Ä–æ–∫ (–Ω–∞ SQL):

```sql
-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ order_id –≤ ODS
SELECT order_id, COUNT(*)
FROM ods.orders
GROUP BY order_id
HAVING COUNT(*) > 1;

-- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏: –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞ –≤—á–µ—Ä–∞?
SELECT 'OK' WHERE EXISTS (
  SELECT 1 FROM ods.orders
  WHERE order_date = CURRENT_DATE - INTERVAL '1 day'
);
```

> üîî **–°–æ–≤–µ—Ç**: –¥–µ–ª–∞–π—Ç–µ DQ-—Ç–µ—Å—Ç—ã —á–∞—Å—Ç—å—é CI/CD ‚Äî –∫–∞–∫ unit-—Ç–µ—Å—Ç—ã –≤ –∫–æ–¥–µ.

---

## **10. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ: –≥–ª–∞–≤–Ω–æ–µ ‚Äî –ø–æ–Ω–∏–º–∞—Ç—å ¬´–ø–æ—á–µ–º—É¬ª**

–•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ ¬´–∫—Ä—É—Ç—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏¬ª, –∞ –ø—Ä–æ **–º—ã—à–ª–µ–Ω–∏–µ**:

- **–°–ª–æ–∏ (STG‚ÜíODS‚ÜíDDS‚ÜíDM)** ‚Äî —ç—Ç–æ –ø—Ä–æ *—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏*.  
  –ù–µ —Å–º–µ—à–∏–≤–∞–π—Ç–µ —Å—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ ‚Äî –∏–Ω–∞—á–µ –Ω–µ –Ω–∞–π–¥—ë—Ç–µ, –≥–¥–µ –æ—à–∏–±–∫–∞.

- **–§–∞–∫—Ç—ã –∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è** ‚Äî —ç—Ç–æ –ø—Ä–æ *—Å—Ç—Ä—É–∫—Ç—É—Ä—É –º—ã—à–ª–µ–Ω–∏—è*.  
  –°–æ–±—ã—Ç–∏—è (—Ñ–∞–∫—Ç—ã) –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç (–∏–∑–º–µ—Ä–µ–Ω–∏—è) ‚Äî –¥–≤–µ —Å—Ç–æ—Ä–æ–Ω—ã –æ–¥–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.

- **SCD Type 2** ‚Äî —ç—Ç–æ –ø—Ä–æ *—É–≤–∞–∂–µ–Ω–∏–µ –∫ –∏—Å—Ç–æ—Ä–∏–∏*.  
  –ë–∏–∑–Ω–µ—Å –º–µ–Ω—è–µ—Ç—Å—è ‚Äî –∏ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã —ç—Ç–æ –æ—Ç—Ä–∞–∂–∞—Ç—å.

- **–ú–æ–¥–µ–ª–∏ (Star/3NF/DV)** ‚Äî —ç—Ç–æ –ø—Ä–æ *–≤—ã–±–æ—Ä –ø–æ–¥ –∑–∞–¥–∞—á—É*.  
  –ù–µ—Ç ¬´—Å–µ—Ä–µ–±—Ä—è–Ω–æ–π –ø—É–ª–∏¬ª ‚Äî –µ—Å—Ç—å –∫–æ–º–ø—Ä–æ–º–∏—Å—Å—ã.

> üéÅ **–§–∏–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫**:  
> –ó–∞–ø–æ–º–Ω–∏—Ç–µ **5 –∑–æ–ª–æ—Ç—ã—Ö –ø—Ä–∞–≤–∏–ª DWH**:  
> 1. –í—Å–µ–≥–¥–∞ —Ö—Ä–∞–Ω–∏—Ç–µ BK (–±–∏–∑–Ω–µ—Å-–∫–ª—é—á) ‚Äî –∏–Ω–∞—á–µ –ø–æ—Ç–µ—Ä—è–µ—Ç–µ —Å–≤—è–∑—å —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º.  
> 2. –í DDS ‚Äî —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ, ¬´—á–∏—Å—Ç—ã–µ¬ª —Å—É—â–Ω–æ—Å—Ç–∏.  
> 3. –í DM ‚Äî —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –æ—Ç—á—ë—Ç–∞.  
> 4. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ *–Ω–∞ –∫–∞–∂–¥–æ–º —Å–ª–æ–µ*.  
> 5. –°–æ–±–∏—Ä–∞–π—Ç–µ –≤–∏—Ç—Ä–∏–Ω—ã *–∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ*: MVP ‚Üí –¥–æ—Ä–∞–±–æ—Ç–∫–∞ ‚Üí –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏.

---

## **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

### üìö –ú–∏–Ω–∏-–≥–ª–æ—Å—Å–∞—Ä–∏–π (RU / EN)

| –¢–µ—Ä–º–∏–Ω | –ü–æ—è—Å–Ω–µ–Ω–∏–µ |
|-------|-----------|
| **–°–ª–æ–π (Layer)** | –õ–æ–≥–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –≤ DWH: STG/ODS/DDS/DM |
| **–í–∏—Ç—Ä–∏–Ω–∞ (Data Mart)** | –ì–æ—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä —Ç–∞–±–ª–∏—Ü –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ–∏–Ω–∞–Ω—Å—ã –∏–ª–∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥) |
| **–§–∞–∫—Ç (Fact)** | –¢–∞–±–ª–∏—Ü–∞ —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π: –ø—Ä–æ–¥–∞–∂–∏, –∫–ª–∏–∫–∏, –∑–≤–æ–Ω–∫–∏ |
| **–ò–∑–º–µ—Ä–µ–Ω–∏–µ (Dimension)** | –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: –∫–ª–∏–µ–Ω—Ç—ã, —Ç–æ–≤–∞—Ä—ã, –¥–∞—Ç–∞ |
| **–°—É—Ä—Ä–æ–≥–∞—Ç–Ω—ã–π –∫–ª—é—á (SK)** | –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π `BIGINT`, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π –≤ DWH |
| **–ë–∏–∑–Ω–µ—Å-–∫–ª—é—á (BK)** | –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (`customer_id`, `order_number`) |
| **SCD (Slowly Changing Dimension)** | –ü–æ–¥—Ö–æ–¥ –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é –∏—Å—Ç–æ—Ä–∏–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏–∑–º–µ—Ä–µ–Ω–∏—è |
| **CDC (Change Data Capture)** | –¢–µ—Ö–Ω–∏–∫–∞ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ ¬´—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π¬ª |
| **Conformed Dimension** | –ò–∑–º–µ—Ä–µ–Ω–∏–µ, –µ–¥–∏–Ω–æ–µ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∏—Ç—Ä–∏–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, `dim_date`) |

---

### üß± –°–∏–Ω–æ–Ω–∏–º—ã —Å–ª–æ—ë–≤ –≤ –∏–Ω–¥—É—Å—Ç—Ä–∏–∏

| –ù–∞–∑–≤–∞–Ω–∏–µ | –°–∏–Ω–æ–Ω–∏–º—ã |
|----------|----------|
| **STG** | Staging, Raw, Bronze, Landing Zone |
| **ODS** | Cleaned, Integrated, Silver |
| **DDS** | Core, Conformed, Golden Layer, Enterprise Data Model |
| **DM** | Data Mart, Semantic Layer, Gold, Analytics Layer |

> ‚ö†Ô∏è –ù–∞–∑–≤–∞–Ω–∏—è –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è ‚Äî —Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ *—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ*, –∞ –Ω–µ –Ω–∞ —è—Ä–ª—ã–∫–∏.

---

### üö´ –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω—ã (—á–µ–≥–æ –∏–∑–±–µ–≥–∞—Ç—å)

| –ê–Ω—Ç–∏–ø–∞—Ç—Ç–µ—Ä–Ω | –ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ |
|-------------|--------------|
| **¬´–û–¥–Ω–∞ –æ–≥—Ä–æ–º–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤¬ª** | –ó–∞–ø—Ä–æ—Å—ã —Ç–æ—Ä–º–æ–∑—è—Ç, –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–∫–ª–∏–µ–Ω—Ç —Å–º–µ–Ω–∏–ª email ‚Äî –∏ –≤—Å—ë –ø—Ä–æ—à–ª–æ–µ ¬´–ø–µ—Ä–µ–∫—Ä–∞—Å–∏–ª–æ—Å—å¬ª) |
| **STG –∏ ODS –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ** | –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å: –æ—à–∏–±–∫–∞ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–µ –∏–ª–∏ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ? |
| **–§–∞–∫—Ç —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏** (`customer_name` –≤ `fact_sales`) | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–∞—Ä—É—à–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏, ¬´—Å–ø—Ä—è—Ç–∞–Ω–Ω–∞—è¬ª –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ |
| **SCD –±–µ–∑ BK** | –ò—Å—Ç–æ—Ä–∏—è ¬´–æ—Ç–≤—è–∑–∞–Ω–∞¬ª –æ—Ç –±–∏–∑–Ω–µ—Å–∞: —É–¥–∞–ª–∏–ª–∏ –∫–ª–∏–µ–Ω—Ç–∞ ‚Äî –∏ –≤—Å—è –µ–≥–æ –∏—Å—Ç–æ—Ä–∏—è –∏—Å—á–µ–∑–ª–∞ |

---

## **–ß–ê–°–¢–¨ C. –ú–∏–Ω–∏-–¥–∞—Ç–∞—Å–µ—Ç (–¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏)**

–í—Å–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–∞–∫—Ç–∏–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ [`data/`](dwh-modeling/data/)) ‚Äî —Ç—Ä–µ–Ω–∏—Ä—É–π—Ç–µ—Å—å:

[**`customers.csv`**](dwh-modeling/data/customers.csv)):
```csv
customer_id,email,phone,city
101,a@ex.com,700,–ú–æ—Å–∫–≤–∞
101,b@ex.com,700,–ú–æ—Å–∫–≤–∞
102,c@ex.com,701,–°–ü–±
```

[**`orders.csv`**](dwh-modeling/data/orders.csv)):
```csv
order_id,order_date,customer_id
5001,2024-01-10,101
5002,2024-02-05,102
```

[**`order_items.csv`**](dwh-modeling/data/order_items.csv)):
```csv
order_item_id,order_id,product_id,qty,price_at_sale
1,5001,9001,2,100.00
2,5001,9002,1,50.00
3,5002,9001,1,100.00
```

[**`products.csv`**](dwh-modeling/data/products.csv)):
```csv
product_id,name
9001,Phone
9002,Case
```

[**`prices.csv`**](dwh-modeling/data/prices.csv)):
```csv
product_id,valid_from,valid_to,price
9001,2023-12-01,2024-01-31,100
9001,2024-02-01,2999-12-31,110
```

>  üìÇ –í—Å–µ SQL-—Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –ø–∞–ø–∫–µ [`sql/`](dwh-modeling/sql/)).

---

## **–ß–ê–°–¢–¨ D. DDL-—Å–∫–µ–ª–µ—Ç—ã (PostgreSQL)**

–ü–æ–ª–Ω—ã–µ DDL-—Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ—ë–≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ [`01_ddl_stg-dds.sql`](dwh-modeling/sql/01_ddl_stg-dds.sql).

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü DDS:

```sql
-- DDS: –∏–∑–º–µ—Ä–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ (SCD Type 2)
CREATE TABLE dds.dim_customer (
    customer_sk   BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    customer_bk   VARCHAR(50) NOT NULL,   -- –Ω–∞–ø—Ä. '101'
    email         VARCHAR(100),
    phone         VARCHAR(20),
    city          VARCHAR(50),
    valid_from    DATE NOT NULL,
    valid_to      DATE DEFAULT '9999-12-31',
    is_current    BOOLEAN NOT NULL DEFAULT TRUE
);

-- DDS: —Ñ–∞–∫—Ç –ø—Ä–æ–¥–∞–∂ (–≥—Ä–∞–Ω—É–ª—è—Ä–Ω–æ—Å—Ç—å: —Å—Ç—Ä–æ–∫–∞ –∑–∞–∫–∞–∑–∞)
CREATE TABLE dds.fact_sales (
    sale_id      BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
    customer_sk  BIGINT NOT NULL REFERENCES dds.dim_customer(customer_sk),
    product_sk   BIGINT NOT NULL,
    date_key     INT NOT NULL,  -- YYYYMMDD, —Å—Å—ã–ª–∫–∞ –Ω–∞ dim_date.date_key
    quantity     INT NOT NULL CHECK (quantity > 0),
    amount       DECIMAL(18,2) NOT NULL CHECK (amount >= 0)
);
```

> üí° `date_key` ‚Äî —ç—Ç–æ `20240110`, –∞ –Ω–µ `DATE`, —á—Ç–æ–±—ã –Ω–µ –¥–µ–ª–∞—Ç—å JOIN –ø–æ –¥–∏–∞–ø–∞–∑–æ–Ω—É –≤ `fact ‚Üí dim_date`.

